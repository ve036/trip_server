[
    {
        "id": "f20b3fe7.75306",
        "type": "tab",
        "label": "GPS-MQTT",
        "disabled": false,
        "info": ""
    },
    {
        "id": "8caaa155.e5486",
        "type": "tab",
        "label": "OwnTrack",
        "disabled": false,
        "info": ""
    },
    {
        "id": "9d68a1c7.f4976",
        "type": "tab",
        "label": "グローバル",
        "disabled": false,
        "info": ""
    },
    {
        "id": "709630c3.37daf",
        "type": "tab",
        "label": "デバッグ",
        "disabled": false,
        "info": ""
    },
    {
        "id": "975620f5.ba38",
        "type": "tab",
        "label": "シリアル入出力",
        "disabled": false,
        "info": ""
    },
    {
        "id": "90be64ef.6b4fc8",
        "type": "tab",
        "label": "初期設定",
        "disabled": false,
        "info": ""
    },
    {
        "id": "df06f9b1.fe75f8",
        "type": "tab",
        "label": "ホームIoT",
        "disabled": false,
        "info": ""
    },
    {
        "id": "361ce87e.80f648",
        "type": "subflow",
        "name": "リセットフィルター",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "c2d88f2e.41a4f"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 400,
                "y": 20,
                "wires": [
                    {
                        "id": "c2d88f2e.41a4f",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 200,
                "wires": [
                    {
                        "id": "83d9255d.60bb78",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "7e6f2d4d.3bcd74",
        "type": "subflow",
        "name": "リセット",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 220,
                "wires": [
                    {
                        "id": "a6aff84e.7382e8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 980,
                "y": 60,
                "wires": [
                    {
                        "id": "4f8a6ac0.efe414",
                        "port": 0
                    }
                ]
            },
            {
                "x": 860,
                "y": 120,
                "wires": [
                    {
                        "id": "f298cc9e.a2cc",
                        "port": 0
                    }
                ]
            },
            {
                "x": 800,
                "y": 260,
                "wires": [
                    {
                        "id": "ce28cb3f.2f3028",
                        "port": 0
                    }
                ]
            },
            {
                "x": 640,
                "y": 320,
                "wires": [
                    {
                        "id": "b582e164.1a557",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "536d4aff.8b6084",
        "type": "subflow",
        "name": "GPSフィルタ",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "500477e9.6feaf8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1000,
                "y": 80,
                "wires": [
                    {
                        "id": "84b8dd27.abd21",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "cd49fe9a.d0506",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED ダッシュボード",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "YYYY/MM/DD",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "c85a0a7c.b517d8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "47ea9204.ae7a84",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "b137cfa6.b1012",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "f955efa3.0dd948",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "72aaf418.1b6fac",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "a06dcf14.da9fa8",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "280c2faa.d1102",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 2,
        "height": 1
    },
    {
        "id": "d7ffb037.641ad",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "3917418e.902c6e",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 7,
        "width": 2,
        "height": 1
    },
    {
        "id": "c7457253.94a3b",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "d2b24659.ed62e8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 9,
        "width": 2,
        "height": 1
    },
    {
        "id": "a1b83968.fc5718",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "b0a8ab87.953188",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 12,
        "width": 2,
        "height": 1
    },
    {
        "id": "a011b762.624898",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 13,
        "width": 1,
        "height": 1
    },
    {
        "id": "e3d463d.fa680a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 14,
        "width": 2,
        "height": 1
    },
    {
        "id": "70f9e3be.3991fc",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 16,
        "width": 1,
        "height": 1
    },
    {
        "id": "4d8d0e67.459c2",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 17,
        "width": 2,
        "height": 1
    },
    {
        "id": "91f85f59.875ff",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 18,
        "width": 1,
        "height": 1
    },
    {
        "id": "624d4424.f71e6c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 4,
        "height": 1
    },
    {
        "id": "36b98bd2.d72254",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 9,
        "width": 4,
        "height": 1
    },
    {
        "id": "ca02cb1.9cf2338",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 10,
        "width": 4,
        "height": 1
    },
    {
        "id": "c26006d.734dff8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 4,
        "height": 1
    },
    {
        "id": "4907b893.ba2058",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 15,
        "width": 4,
        "height": 1
    },
    {
        "id": "c3b3aa8f.99ef68",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 3,
        "height": 1
    },
    {
        "id": "71637db9.b7ac14",
        "type": "ui_tab",
        "name": "2移動GPS",
        "icon": "dashboard",
        "order": 6,
        "disabled": true,
        "hidden": true
    },
    {
        "id": "7909180b.3de5f8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "47ea9204.ae7a84",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "7bc8d4e7.c9a21c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "f955efa3.0dd948",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "823ab102.74be7",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "a06dcf14.da9fa8",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "669d493f.7802b8",
        "type": "ui_tab",
        "name": "受信点",
        "icon": "dashboard",
        "order": 7,
        "disabled": true,
        "hidden": true
    },
    {
        "id": "7822e817.03bb38",
        "type": "ui_group",
        "name": "1移動走行データ",
        "tab": "",
        "order": 2,
        "disp": true,
        "width": 15,
        "collapse": false
    },
    {
        "id": "e2309ec6.af331",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 12,
        "width": 3,
        "height": 1
    },
    {
        "id": "3eb7d4d2.adcacc",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 17,
        "width": 3,
        "height": 1
    },
    {
        "id": "90217899.bc9808",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 20,
        "width": 5,
        "height": 1
    },
    {
        "id": "85884056.b7eea",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 23,
        "width": 3,
        "height": 1
    },
    {
        "id": "8524d321.969d6",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 25,
        "width": 6,
        "height": 1
    },
    {
        "id": "f85c7d7e.02d6a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 3,
        "height": 1
    },
    {
        "id": "43f4f39.b4faf8c",
        "type": "ui_tab",
        "name": "コントロール",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "4a48ee78.c45ed",
        "type": "ui_group",
        "name": "GPS距離計コントロール",
        "tab": "43f4f39.b4faf8c",
        "order": 3,
        "disp": true,
        "width": 8,
        "collapse": true
    },
    {
        "id": "665ac286.d04e5c",
        "type": "serial-port",
        "serialport": "/dev/ttyUSB0",
        "serialbaud": "1200",
        "databits": "8",
        "parity": "none",
        "stopbits": "1",
        "waitfor": "0xaa",
        "dtr": "none",
        "rts": "none",
        "cts": "none",
        "dsr": "none",
        "newline": "13",
        "bin": "bin",
        "out": "count",
        "addchar": "",
        "responsetimeout": "10000"
    },
    {
        "id": "144a4fe6.b3e0a",
        "type": "ui_tab",
        "name": "距離計",
        "icon": "dashboard",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "b632e2e1.1dd7c",
        "type": "ui_group",
        "name": "距離計",
        "tab": "144a4fe6.b3e0a",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "3f68c82e.d48428",
        "type": "ui_group",
        "name": "移動車情報",
        "tab": "",
        "order": 2,
        "disp": true,
        "width": 6,
        "collapse": true
    },
    {
        "id": "ac7569b4.5ada88",
        "type": "mqtt-broker",
        "name": "moquitto",
        "broker": "ve036.mydns.jp",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "693bf46.1e1860c",
        "type": "ui_group",
        "name": "3移動",
        "tab": "43f4f39.b4faf8c",
        "order": 2,
        "disp": true,
        "width": 8,
        "collapse": true
    },
    {
        "id": "b90ab216.c29668",
        "type": "ui_group",
        "name": "1移動",
        "tab": "43f4f39.b4faf8c",
        "order": 1,
        "disp": true,
        "width": 8,
        "collapse": true
    },
    {
        "id": "7de7e0c3.f4fbf",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "3f68c82e.d48428",
        "order": 10,
        "width": 3,
        "height": 1
    },
    {
        "id": "4646bf9b.55c01",
        "type": "mqtt-broker",
        "name": "localhost",
        "broker": "localhost",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "compatmode": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "c3624d3c.be7fe",
        "type": "alexa-home-conf",
        "username": "ve036g@gmail.com"
    },
    {
        "id": "c1d1dd9b.641f3",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "7822e817.03bb38",
        "order": 11,
        "width": 15,
        "height": 1
    },
    {
        "id": "9b9f4e23.babf",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "7822e817.03bb38",
        "order": 13,
        "width": 12,
        "height": 1
    },
    {
        "id": "ef5aeaa.672a718",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "7822e817.03bb38",
        "order": 14,
        "width": 12,
        "height": 1
    },
    {
        "id": "665e6fe7.032d4",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "7822e817.03bb38",
        "order": 15,
        "width": 12,
        "height": 1
    },
    {
        "id": "aa07f1cb.d48f",
        "type": "ui_group",
        "name": "チャート",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "15",
        "collapse": true
    },
    {
        "id": "945b4dc3.20a2d",
        "type": "ui_group",
        "name": "地図",
        "tab": "",
        "order": 3,
        "disp": true,
        "width": 9,
        "collapse": true
    },
    {
        "id": "4707e75.554a618",
        "type": "ui_group",
        "name": "移動車情報",
        "tab": "9d14b21b.7b4f3",
        "order": 1,
        "disp": false,
        "width": 7,
        "collapse": false
    },
    {
        "id": "9d14b21b.7b4f3",
        "type": "ui_tab",
        "name": "スマホ",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "468b369c.486228",
        "type": "ui_spacer",
        "z": "f20b3fe7.75306",
        "name": "spacer",
        "group": "693bf46.1e1860c",
        "order": 18,
        "width": 2,
        "height": 1
    },
    {
        "id": "4492d49d.49d35c",
        "type": "ui_spacer",
        "z": "f20b3fe7.75306",
        "name": "spacer",
        "group": "693bf46.1e1860c",
        "order": 20,
        "width": 1,
        "height": 1
    },
    {
        "id": "bfbadc93.6ec17",
        "type": "ui_spacer",
        "z": "f20b3fe7.75306",
        "name": "spacer",
        "group": "693bf46.1e1860c",
        "order": 22,
        "width": 5,
        "height": 1
    },
    {
        "id": "1b2cba59.b4d366",
        "type": "ui_spacer",
        "z": "f20b3fe7.75306",
        "name": "spacer",
        "group": "4a48ee78.c45ed",
        "order": 4,
        "width": 3,
        "height": 1
    },
    {
        "id": "3d6df3db.cc4fdc",
        "type": "cast-to-client",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "url": "",
        "contentType": "",
        "message": "あゆみん、もうすぐバスが来るよ、幼稚園に行くにゃん",
        "language": "Ja",
        "ip": "192.168.24.10",
        "port": "8009",
        "volume": "70",
        "x": 450,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "9c3b1d6.29d05e",
        "type": "inject",
        "z": "df06f9b1.fe75f8",
        "name": "幼稚園バス",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "15 08 * * 1,2,3,4,5",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 40,
        "wires": [
            [
                "3d6df3db.cc4fdc"
            ]
        ]
    },
    {
        "id": "1a4bac5e.b19c54",
        "type": "cast-to-client",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "url": "",
        "contentType": "",
        "message": "きんきゅうじたい、みかさ、あゆみん、アリストグレートで出動してください",
        "language": "ja",
        "ip": "192.168.24.10",
        "port": "8009",
        "volume": "70",
        "x": 710,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "b9374d55.c57ae",
        "type": "exec",
        "z": "df06f9b1.fe75f8",
        "command": "sudo python /home/pi/python-host/switchbot.py F2:01:52:50:80:7D  Press",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 590,
        "y": 360,
        "wires": [
            [],
            [],
            [
                "bb538542.025c68",
                "49a74f74.dba1e"
            ]
        ]
    },
    {
        "id": "a2ba1203.ea8b2",
        "type": "inject",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 360,
        "wires": [
            [
                "b9374d55.c57ae"
            ]
        ]
    },
    {
        "id": "bb538542.025c68",
        "type": "cast-to-client",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "url": "",
        "contentType": "",
        "message": "お湯、ためます",
        "language": "ja",
        "ip": "192.168.24.10",
        "port": "8009",
        "volume": "",
        "x": 1030,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "35ec7858.d5db08",
        "type": "mqtt in",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "topic": "switchbot",
        "qos": "2",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 120,
        "y": 420,
        "wires": [
            [
                "b9374d55.c57ae"
            ]
        ]
    },
    {
        "id": "500893be.1e4b4c",
        "type": "debug",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 330,
        "y": 480,
        "wires": []
    },
    {
        "id": "a5ff8180.90b18",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "inject",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "date"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 80,
        "wires": [
            [
                "d2f2d24e.38827"
            ]
        ]
    },
    {
        "id": "d2f2d24e.38827",
        "type": "template",
        "z": "709630c3.37daf",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "one\ntwo\nthree\nfour\nfive",
        "output": "str",
        "x": 260,
        "y": 80,
        "wires": [
            [
                "fa0c4f1a.08427"
            ]
        ]
    },
    {
        "id": "fa0c4f1a.08427",
        "type": "split",
        "z": "709630c3.37daf",
        "name": "",
        "splt": "\\n",
        "x": 210,
        "y": 140,
        "wires": [
            [
                "9ba1843.7f68878"
            ]
        ]
    },
    {
        "id": "9ba1843.7f68878",
        "type": "change",
        "z": "709630c3.37daf",
        "name": "Prepend line number",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "(parts.index+1) & \": \" & payload",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 140,
        "wires": [
            [
                "118afbc5.681f84"
            ]
        ]
    },
    {
        "id": "118afbc5.681f84",
        "type": "join",
        "z": "709630c3.37daf",
        "name": "",
        "mode": "auto",
        "build": "string",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "timeout": "",
        "count": "",
        "x": 550,
        "y": 140,
        "wires": [
            [
                "3cdc924a.9c1f0e"
            ]
        ]
    },
    {
        "id": "3cdc924a.9c1f0e",
        "type": "debug",
        "z": "709630c3.37daf",
        "name": "debug",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 670,
        "y": 140,
        "wires": []
    },
    {
        "id": "e3780f9c.79695",
        "type": "file in",
        "z": "709630c3.37daf",
        "name": "",
        "filename": "/home/pi/samba/public/result.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 440,
        "y": 240,
        "wires": [
            [
                "6ef47163.32124"
            ]
        ]
    },
    {
        "id": "6ef47163.32124",
        "type": "csv",
        "z": "709630c3.37daf",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 680,
        "y": 240,
        "wires": [
            [
                "15ae8d31.2fbb93"
            ]
        ]
    },
    {
        "id": "15ae8d31.2fbb93",
        "type": "debug",
        "z": "709630c3.37daf",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 220,
        "wires": []
    },
    {
        "id": "2f8298aa.813008",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 240,
        "wires": [
            [
                "50bb16d5.dd8188",
                "e3780f9c.79695"
            ]
        ]
    },
    {
        "id": "50bb16d5.dd8188",
        "type": "file in",
        "z": "709630c3.37daf",
        "name": "",
        "filename": "/home/pi/samba/public/reset.log",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 390,
        "y": 300,
        "wires": [
            [
                "e4796936.9d3818"
            ]
        ]
    },
    {
        "id": "e4796936.9d3818",
        "type": "split",
        "z": "709630c3.37daf",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 690,
        "y": 300,
        "wires": [
            [
                "c7f1e0e6.9f98d"
            ]
        ]
    },
    {
        "id": "c7f1e0e6.9f98d",
        "type": "json",
        "z": "709630c3.37daf",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 840,
        "y": 300,
        "wires": [
            [
                "5a1930f3.c9387"
            ]
        ]
    },
    {
        "id": "5a1930f3.c9387",
        "type": "join",
        "z": "709630c3.37daf",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload.trip",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 980,
        "y": 300,
        "wires": [
            [
                "15ae8d31.2fbb93"
            ]
        ]
    },
    {
        "id": "dd792881.45f3b8",
        "type": "debug",
        "z": "709630c3.37daf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 540,
        "wires": []
    },
    {
        "id": "bd7dd1a.6335f3",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 540,
        "wires": [
            [
                "9244268a.432c58",
                "8a08c6aa.fd7f18",
                "f16ad803.c151b8"
            ]
        ]
    },
    {
        "id": "9244268a.432c58",
        "type": "cpu",
        "z": "709630c3.37daf",
        "name": "",
        "msgCore": false,
        "msgOverall": true,
        "msgArray": false,
        "msgTemp": false,
        "x": 390,
        "y": 540,
        "wires": [
            [
                "dd792881.45f3b8"
            ]
        ]
    },
    {
        "id": "a5f05279.21d9b",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 680,
        "wires": [
            [
                "7abb389a.a3f3f8"
            ]
        ]
    },
    {
        "id": "7abb389a.a3f3f8",
        "type": "change",
        "z": "709630c3.37daf",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "start",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "8a08c6aa.fd7f18",
        "type": "Memory",
        "z": "709630c3.37daf",
        "name": "",
        "scale": "Byte",
        "x": 400,
        "y": 600,
        "wires": [
            [
                "dd792881.45f3b8"
            ]
        ]
    },
    {
        "id": "f16ad803.c151b8",
        "type": "Uptime",
        "z": "709630c3.37daf",
        "name": "",
        "x": 200,
        "y": 460,
        "wires": [
            [
                "aad996c1.8ab538"
            ]
        ]
    },
    {
        "id": "3b29ec81.5c7554",
        "type": "ui_text",
        "z": "709630c3.37daf",
        "d": true,
        "group": "4a48ee78.c45ed",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "稼働時間",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1000,
        "y": 460,
        "wires": []
    },
    {
        "id": "aad996c1.8ab538",
        "type": "change",
        "z": "709630c3.37daf",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "msg.payload.uptime*1000",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 400,
        "y": 460,
        "wires": [
            [
                "b10fac42.4e2df"
            ]
        ]
    },
    {
        "id": "b10fac42.4e2df",
        "type": "moment",
        "z": "709630c3.37daf",
        "name": "",
        "topic": "",
        "input": "",
        "inputType": "msg",
        "inTz": "Asia/Tokyo",
        "adjAmount": "0",
        "adjType": "hours",
        "adjDir": "subtract",
        "format": "Mo-DD HH:mm:ss",
        "locale": "ja-JP",
        "output": "",
        "outputType": "msg",
        "outTz": "Asia/Tokyo",
        "x": 620,
        "y": 460,
        "wires": [
            [
                "3b29ec81.5c7554",
                "dd792881.45f3b8"
            ]
        ]
    },
    {
        "id": "519fca95.425bd4",
        "type": "exec",
        "z": "709630c3.37daf",
        "command": "node-red-restart",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 380,
        "y": 760,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "adaeae9a.cfc17",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 760,
        "wires": [
            [
                "519fca95.425bd4"
            ]
        ]
    },
    {
        "id": "4a2b056c.ea139c",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "60",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 860,
        "wires": [
            [
                "814a3de5.48d29"
            ]
        ]
    },
    {
        "id": "c6825642.489a68",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 1020,
        "wires": [
            [
                "b5ad5c72.52e51"
            ]
        ]
    },
    {
        "id": "b5ad5c72.52e51",
        "type": "exec",
        "z": "709630c3.37daf",
        "command": "sudo reboot",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 390,
        "y": 1020,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "814a3de5.48d29",
        "type": "DeviceStats",
        "z": "709630c3.37daf",
        "name": "",
        "mem": true,
        "nw": false,
        "load": true,
        "hostname": false,
        "useString": false,
        "x": 370,
        "y": 860,
        "wires": [
            [
                "6120a66.e4d1358"
            ]
        ]
    },
    {
        "id": "6120a66.e4d1358",
        "type": "template",
        "z": "709630c3.37daf",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "momory used:{{payload.mem.used}}\nload : {{payload.load.0}} : {{payload.load.1}} : {{payload.load.2}}",
        "output": "str",
        "x": 560,
        "y": 860,
        "wires": [
            [
                "43f88189.fdf2c",
                "63238f56.f0c4f"
            ]
        ]
    },
    {
        "id": "43f88189.fdf2c",
        "type": "debug",
        "z": "709630c3.37daf",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 960,
        "wires": []
    },
    {
        "id": "63238f56.f0c4f",
        "type": "ui_text",
        "z": "709630c3.37daf",
        "group": "4a48ee78.c45ed",
        "order": 7,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 730,
        "y": 860,
        "wires": []
    },
    {
        "id": "1a938a47.50b8f6",
        "type": "inject",
        "z": "709630c3.37daf",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 1080,
        "wires": [
            [
                "e9bf6920.34e268"
            ]
        ]
    },
    {
        "id": "e9bf6920.34e268",
        "type": "exec",
        "z": "709630c3.37daf",
        "command": "sudo shutdown -h now",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 420,
        "y": 1080,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "196633d5.7bebfc",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 680,
        "wires": []
    },
    {
        "id": "b2f9fa84.8eb638",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "1移動",
        "rules": [
            {
                "t": "set",
                "p": "payload.name",
                "pt": "msg",
                "to": "1移動",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.iconColor",
                "pt": "msg",
                "to": "blue",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.icon",
                "pt": "msg",
                "to": "arrow",
                "tot": "str"
            },
            {
                "t": "move",
                "p": "payload.track",
                "pt": "msg",
                "to": "payload.bearing",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 760,
        "wires": [
            [
                "196633d5.7bebfc",
                "b74f199d.ee4458",
                "d4073990.037ef8",
                "9d5ce64.d0dd718",
                "b8b1cea0.7dd62"
            ]
        ]
    },
    {
        "id": "acf13e0f.30543",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "初期化",
        "func": "flow.set(\"odd\",0);\n//flow.set(\"odds\",0);\nmsg.payload={\n    dis:0.00,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1470,
        "y": 820,
        "wires": [
            [
                "c848b4a6.5a3658"
            ]
        ]
    },
    {
        "id": "c7173fb2.78d0e",
        "type": "ui_button",
        "z": "f20b3fe7.75306",
        "name": "",
        "group": "b90ab216.c29668",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "リセット",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "",
        "topicType": "str",
        "x": 1220,
        "y": 900,
        "wires": [
            [
                "6af66162.2cec"
            ]
        ]
    },
    {
        "id": "3d315aae.71ac46",
        "type": "mqtt in",
        "z": "f20b3fe7.75306",
        "name": "",
        "topic": "trip1/zero",
        "qos": "2",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 1300,
        "y": 820,
        "wires": [
            [
                "acf13e0f.30543"
            ]
        ]
    },
    {
        "id": "490ca967.0c5618",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "true/false",
        "func": "context.flow.move = !context.flow.move;\nmsg.payload = context.flow.move;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\n//context.flow.move==true;\n//flow.set(\"pause\",false);",
        "finalize": "",
        "x": 280,
        "y": 1260,
        "wires": [
            [
                "7a95fa74.9bada4"
            ]
        ]
    },
    {
        "id": "3173b28b.6b82de",
        "type": "mqtt in",
        "z": "f20b3fe7.75306",
        "name": "",
        "topic": "trip1/pause",
        "qos": "0",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 100,
        "y": 1320,
        "wires": [
            [
                "d1ec4eb2.66e0f",
                "8f7f03fe.1577a"
            ]
        ]
    },
    {
        "id": "4ba52c68.687244",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 660,
        "y": 1260,
        "wires": [
            [
                "211f1b22.c58a34"
            ],
            [
                "52bf0e5d.b1a71"
            ]
        ]
    },
    {
        "id": "9e50d3c9.6e8fe",
        "type": "ui_button",
        "z": "f20b3fe7.75306",
        "name": "",
        "group": "b90ab216.c29668",
        "order": 1,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "{{msg.topic}}",
        "tooltip": "",
        "color": "",
        "bgcolor": " {{msg.background}}",
        "icon": "",
        "payload": "",
        "payloadType": "date",
        "topic": "",
        "topicType": "str",
        "x": 130,
        "y": 1260,
        "wires": [
            [
                "490ca967.0c5618"
            ]
        ]
    },
    {
        "id": "dece2816.98ac98",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "limit",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 1420,
        "wires": [
            [
                "ecce0f12.9c768"
            ]
        ]
    },
    {
        "id": "7a95fa74.9bada4",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pause",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 1260,
        "wires": [
            [
                "4ba52c68.687244"
            ]
        ]
    },
    {
        "id": "500477e9.6feaf8",
        "type": "switch",
        "z": "536d4aff.8b6084",
        "name": "flow.limit",
        "property": "payload.kmh",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lte",
                "v": "$parent.limit",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "8e434a16.1a3558"
            ]
        ]
    },
    {
        "id": "db6304f.419adf8",
        "type": "ui_slider",
        "z": "f20b3fe7.75306",
        "name": "",
        "label": "最低速度",
        "tooltip": "",
        "group": "b90ab216.c29668",
        "order": 11,
        "width": 6,
        "height": 1,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "min": 0,
        "max": "5",
        "step": "0.2",
        "x": 380,
        "y": 1480,
        "wires": [
            [
                "5d22187b.dd8d98"
            ]
        ]
    },
    {
        "id": "e9fbef68.a9103",
        "type": "ui_text",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "order": 10,
        "width": 2,
        "height": 1,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}ｋｍ",
        "layout": "row-spread",
        "x": 740,
        "y": 1480,
        "wires": []
    },
    {
        "id": "8c7170d0.ed4a6",
        "type": "ui_slider",
        "z": "f20b3fe7.75306",
        "name": "",
        "label": "速度制限",
        "tooltip": "",
        "group": "b90ab216.c29668",
        "order": 13,
        "width": 6,
        "height": 1,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "min": "10",
        "max": "180",
        "step": "10",
        "x": 370,
        "y": 1420,
        "wires": [
            [
                "dece2816.98ac98"
            ]
        ]
    },
    {
        "id": "ecce0f12.9c768",
        "type": "ui_text",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "order": 12,
        "width": 2,
        "height": 1,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}ｋｍ",
        "layout": "row-spread",
        "x": 750,
        "y": 1420,
        "wires": []
    },
    {
        "id": "5d22187b.dd8d98",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "min",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 1480,
        "wires": [
            [
                "e9fbef68.a9103"
            ]
        ]
    },
    {
        "id": "211f1b22.c58a34",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "red",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "計測中",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1120,
        "y": 1200,
        "wires": [
            [
                "9e50d3c9.6e8fe"
            ]
        ]
    },
    {
        "id": "52bf0e5d.b1a71",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "blue",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "PAUSE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 1320,
        "wires": [
            [
                "9e50d3c9.6e8fe"
            ]
        ]
    },
    {
        "id": "1d2a44dd.f7a67b",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "odd1",
                "pt": "global",
                "to": "payload.odd",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2220,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "6b0b35aa.dcfbec",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "100",
        "payloadType": "num",
        "x": 210,
        "y": 1420,
        "wires": [
            [
                "8c7170d0.ed4a6"
            ]
        ]
    },
    {
        "id": "f59a427b.32e1e",
        "type": "serial in",
        "z": "975620f5.ba38",
        "name": "",
        "serial": "665ac286.d04e5c",
        "x": 90,
        "y": 40,
        "wires": [
            [
                "6c4ba7eb.f8c328"
            ]
        ]
    },
    {
        "id": "ba74e44a.1144e8",
        "type": "debug",
        "z": "975620f5.ba38",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 40,
        "wires": []
    },
    {
        "id": "e55a8555.82aee8",
        "type": "function",
        "z": "975620f5.ba38",
        "name": "TBS距離計フォーマット",
        "func": "car=msg.payload[1]>>4;\nem=msg.payload[1]&15;\nzenku1=msg.payload[2]>>4;\nzenku2=msg.payload[2]&15;\ngenku1=msg.payload[3]>>4;\ngenku2=msg.payload[3]&15;\nkukyori1=msg.payload[4]>>4;\nkukyori2=msg.payload[4]&15;\nkukyori3=msg.payload[5]>>4;\nkukyori4=msg.payload[5]&15;\nkukyori5=msg.payload[6]>>4;\nkukyori6=msg.payload[6]&15;\nkukyori=kukyori1*100000+kukyori2*10000+kukyori3*1000\n+kukyori4*100+kukyori5*10+kukyori6;\nkyori1=msg.payload[7]>>4;\nkyori2=msg.payload[7]&15;\nkyori3=msg.payload[8]>>4;\nkyori4=msg.payload[8]&15;\nkyori5=msg.payload[9]>>4;\nkyori6=msg.payload[9]&15;\nkyori=kyori1*100000+kyori2*10000+kyori3*1000\n+kyori4*100+kyori5*10+kyori6;\nkyori=kyori/1000;\nsum1=msg.payload[10]>>4;\nsum2=msg.payload[10]&15;\n\nvar sum=0;\nfor(var i=1;i<=9;i++){\n    sum += msg.payload[i]\n}\nck1=sum>>4;\nck1=ck1&15;\nck2=sum&15;\n\nif(em==1){\n    type=\"駅伝\";\n}\nelse if(em==2){\n    type=\"マラソン\";\n}\nmsg.payload={\n    car:car,\n    type:type,\n    zenku:zenku1*10+zenku2,\n    genku:genku1*10+genku2,\n    kukyori:kukyori/1000,\n    kyori:kyori.toFixed(2),\n    sum:sum\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 690,
        "y": 40,
        "wires": [
            [
                "ba74e44a.1144e8",
                "20db6b00.c96d26"
            ]
        ]
    },
    {
        "id": "20db6b00.c96d26",
        "type": "template",
        "z": "975620f5.ba38",
        "name": "距離計",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{payload.type}}:{{payload.car}}号車\n{{payload.genku}}区:{{payload.kyori}}/{{payload.kukyori}}km ",
        "output": "str",
        "x": 670,
        "y": 140,
        "wires": [
            [
                "ecb45852.7ef608"
            ]
        ]
    },
    {
        "id": "ecb45852.7ef608",
        "type": "ui_text",
        "z": "975620f5.ba38",
        "group": "b632e2e1.1dd7c",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "距離計表示",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "x": 870,
        "y": 140,
        "wires": []
    },
    {
        "id": "878ec698.3b9598",
        "type": "function",
        "z": "975620f5.ba38",
        "name": "chk sum",
        "func": "sum1=msg.payload[10]&15;\nsum2=msg.payload[11]&15;\n\nvar sum=0;\nfor(var i=1;i<=9;i++){\n    sum += msg.payload[i]\n}\nck1=sum>>4;\nck1=ck1&15;\nck2=sum&15\nif(ck1 == sum1 && ck2 == sum2){\n    msg.payload=msg.payload;\n    return msg;\n}\nelse{\n    msg.payload=\"eroor\";\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 40,
        "wires": [
            [
                "e55a8555.82aee8",
                "1e77aaeb.7b8b75"
            ]
        ]
    },
    {
        "id": "1e77aaeb.7b8b75",
        "type": "debug",
        "z": "975620f5.ba38",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 140,
        "wires": []
    },
    {
        "id": "6c4ba7eb.f8c328",
        "type": "switch",
        "z": "975620f5.ba38",
        "name": "0xBB",
        "property": "payload[12]",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0xbb",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 290,
        "y": 40,
        "wires": [
            [
                "878ec698.3b9598"
            ]
        ]
    },
    {
        "id": "ef57c73a.e88ea8",
        "type": "function",
        "z": "975620f5.ba38",
        "name": "テスト距離データ",
        "func": "msg.payload={\n    car:2,\n    em:1,\n    zenku:9,\n    genku:5,\n    kukyori:12345,\n    kyori:11345,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 110,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "e5f734cd.f03418",
        "type": "inject",
        "z": "9d68a1c7.f4976",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 900,
        "wires": [
            [
                "82571112.6d78"
            ]
        ]
    },
    {
        "id": "82571112.6d78",
        "type": "moment",
        "z": "9d68a1c7.f4976",
        "name": "",
        "topic": "",
        "input": "",
        "inputType": "msg",
        "inTz": "Asia/Tokyo",
        "adjAmount": "9",
        "adjType": "hours",
        "adjDir": "add",
        "format": "",
        "locale": "ja-JP",
        "output": "",
        "outputType": "msg",
        "outTz": "Asia/Tokyo",
        "x": 440,
        "y": 900,
        "wires": [
            [
                "e72f0d01.37074",
                "ababc231.a3794"
            ]
        ]
    },
    {
        "id": "e72f0d01.37074",
        "type": "ui_text",
        "z": "9d68a1c7.f4976",
        "group": "b90ab216.c29668",
        "order": 9,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "サーバー時間",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 740,
        "y": 940,
        "wires": []
    },
    {
        "id": "b7996dc.f7f6f9",
        "type": "catch",
        "z": "9d68a1c7.f4976",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 1180,
        "y": 180,
        "wires": [
            [
                "5f3c8167.759ca"
            ]
        ]
    },
    {
        "id": "5f3c8167.759ca",
        "type": "debug",
        "z": "9d68a1c7.f4976",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1360,
        "y": 180,
        "wires": []
    },
    {
        "id": "18851a9a.67c905",
        "type": "ui_text_input",
        "z": "f20b3fe7.75306",
        "name": "",
        "label": "1距離補正",
        "tooltip": "",
        "group": "b90ab216.c29668",
        "order": 3,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "payload",
        "topicType": "msg",
        "x": 1350,
        "y": 700,
        "wires": [
            [
                "7dda2e42.b7a2f"
            ]
        ]
    },
    {
        "id": "8bfe9999.0244d8",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 210,
        "y": 1480,
        "wires": [
            [
                "db6304f.419adf8"
            ]
        ]
    },
    {
        "id": "d2f53883.4aeef8",
        "type": "mqtt out",
        "z": "9d68a1c7.f4976",
        "name": "",
        "topic": "owntracks/nodered/aquos/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "4646bf9b.55c01",
        "x": 930,
        "y": 1060,
        "wires": []
    },
    {
        "id": "895e93a1.20dd8",
        "type": "function",
        "z": "9d68a1c7.f4976",
        "name": "owntracksコマンド作成",
        "func": "msg.payload={\n    _type:\"cmd\",\n    action: \"setConfiguration\",\n    configuration:{\n        _type: \"configuration\",\n        moveModeLocatorInterval:1,\n        locatorPriority:3, \n        ignoreInaccurateLocations:40,\n        extendedData:false,\n        pubRetain:true,\n        pubQos :0,\n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 1100,
        "wires": [
            [
                "670e1ed4.e77ed"
            ]
        ]
    },
    {
        "id": "8477cdc0.341f",
        "type": "inject",
        "z": "9d68a1c7.f4976",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 1100,
        "wires": [
            [
                "895e93a1.20dd8"
            ]
        ]
    },
    {
        "id": "670e1ed4.e77ed",
        "type": "json",
        "z": "9d68a1c7.f4976",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 650,
        "y": 1060,
        "wires": [
            [
                "d2f53883.4aeef8",
                "bcda37aa.9c23e8"
            ]
        ]
    },
    {
        "id": "3f6b5fb8.e68f8",
        "type": "mqtt in",
        "z": "9d68a1c7.f4976",
        "name": "",
        "topic": "owntracks/nodered/aquos/dump",
        "qos": "2",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 230,
        "y": 1260,
        "wires": [
            [
                "af93e9f0.3d7588"
            ]
        ]
    },
    {
        "id": "af93e9f0.3d7588",
        "type": "json",
        "z": "9d68a1c7.f4976",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 470,
        "y": 1260,
        "wires": [
            [
                "e05b3ae1.672e88"
            ]
        ]
    },
    {
        "id": "e05b3ae1.672e88",
        "type": "debug",
        "z": "9d68a1c7.f4976",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 660,
        "y": 1260,
        "wires": []
    },
    {
        "id": "ff842760.9a2338",
        "type": "ui_dropdown",
        "z": "9d68a1c7.f4976",
        "name": "",
        "label": "locatorPriority",
        "tooltip": "",
        "place": "BALANCED",
        "group": "693bf46.1e1860c",
        "order": 19,
        "width": 4,
        "height": 1,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "LOW POWER",
                "value": 1,
                "type": "num"
            },
            {
                "label": "BALANCED",
                "value": 2,
                "type": "num"
            },
            {
                "label": "HIGH POWER",
                "value": 3,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "x": 140,
        "y": 1040,
        "wires": [
            [
                "de69d583.8f25c8"
            ]
        ]
    },
    {
        "id": "de69d583.8f25c8",
        "type": "function",
        "z": "9d68a1c7.f4976",
        "name": "owntracksコマンド作成",
        "func": "msg.payload={\n    _type:\"cmd\",\n    action: \"setConfiguration\",\n    configuration:{\n        _type: \"configuration\",\n        //moveModeLocatorInterval:1,\n        locatorPriority:msg.payload, \n        //ignoreInaccurateLocations:40,\n        //extendedData:false,\n        //pubRetain:true,\n        //pubQos :0,\n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 1040,
        "wires": [
            [
                "670e1ed4.e77ed"
            ]
        ]
    },
    {
        "id": "b3f0456.9a8ddb8",
        "type": "mqtt in",
        "z": "f20b3fe7.75306",
        "name": "",
        "topic": "owntracks/GPS/pi",
        "qos": "0",
        "datatype": "json",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 130,
        "y": 340,
        "wires": [
            [
                "7123cfee.e61d7",
                "9abb53f8.d2b2f",
                "754ce382.19c90c"
            ]
        ]
    },
    {
        "id": "1616e587.6aa70a",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "lat not null",
        "property": "payload.lat",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 130,
        "y": 580,
        "wires": [
            [
                "54d68554.0c2bfc"
            ]
        ]
    },
    {
        "id": "e9f75be9.d371f8",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "前後GPS",
        "func": "msg.payload={\n    lat:msg.payload.lat,\n    lon:msg.payload.lon,\n    latx:latx,\n    lony:lony,\n    tstd:tstd,\n    altd:altd,\n    //name:msg.payload.name,\n    alt:msg.payload.alt,\n    tst:msg.payload.time,\n    track:msg.payload.track,\n    speed:msg.payload.speed,\n    climb: msg.payload.climb,\n    acc:(msg.payload.epx+msg.payload.epy)/2,\n}\nlatx=msg.payload.lat;\nlony=msg.payload.lon;\ntstd=msg.payload.tst;\naltd=msg.payload.alt;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nlatx=0;\nlony=0;\ntstd=0;\naltd=0;",
        "finalize": "",
        "x": 340,
        "y": 560,
        "wires": [
            [
                "ea829e3.852856"
            ]
        ]
    },
    {
        "id": "ea829e3.852856",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "latx not 0",
        "property": "payload.latx",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 340,
        "y": 620,
        "wires": [
            [
                "3c14b1b7.5b4b6e"
            ]
        ]
    },
    {
        "id": "3c14b1b7.5b4b6e",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "@時差距離re角度",
        "func": "function distance(lat1, lng1, lat2, lng2 ) {//２点間距離\n    \n         lat1 *= Math.PI / 180;\n         lng1 *= Math.PI / 180;\n         lat2 *= Math.PI / 180;\n         lng2 *= Math.PI / 180;\n         dis = 1000*6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2))\n         return (Math.round(dis * 100)) / 100;\n    \n     \n}\n\nfunction direction(y1, x1, y2, x2) {//２点間角度\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI / 180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n   \n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\nreturn (Math.floor(dir*100)) / 100;\n}\n\nfunction redirection(y1, x1, y2, x2, bearing) {//進行方向との角度\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI /180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\n    re_dir=dir-bearing;\n    if(re_dir<0){\n        re_dir=re_dir+360;\n    }\nreturn (Math.floor(re_dir*100)) / 100;\n}\n\n\ngenku=flow.get(\"genku\");\nreset=flow.get(\"reset\");\ndist=distance(msg.payload.lat,msg.payload.lon,msg.payload.latx, msg.payload.lony);\n\n\nif(dist>=0){\nmsg.payload={\n    dis:dist,\n    track: msg.payload.track,\n    lat: msg.payload.lat,\n    lon: msg.payload.lon,\n    latx:msg.payload.latx,\n    lony:msg.payload.lony,\n    tst: msg.payload.tst,\n    tstd: msg.payload.tstd,\n    alt: msg.payload.alt,\n    altd: msg.payload.altd,\n    speed:msg.payload.speed,\n    kmh:msg.payload.speed*3.6,\n    //kmh: Math.round((msg.payload.speed*3.6*100))/100,\n    climb: msg.payload.climb,\n    acc:msg.payload.acc,\n    //device: msg.payload.device,\n    };\nreturn msg;\n}\n//}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\ndist=0.00",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 680,
        "wires": [
            [
                "b2f9fa84.8eb638"
            ]
        ]
    },
    {
        "id": "28068e36.4c17d2",
        "type": "moment",
        "z": "f20b3fe7.75306",
        "name": "",
        "topic": "",
        "input": "payload.time",
        "inputType": "msg",
        "inTz": "Asia/Tokyo",
        "adjAmount": "9",
        "adjType": "hours",
        "adjDir": "add",
        "format": "",
        "locale": "ja-JP",
        "output": "payload.time",
        "outputType": "msg",
        "outTz": "Asia/Tokyo",
        "x": 360,
        "y": 400,
        "wires": [
            [
                "b8e9fb5a.3eb3b8"
            ]
        ]
    },
    {
        "id": "b8e9fb5a.3eb3b8",
        "type": "ui_text",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "order": 8,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "GPS発行時間",
        "format": "{{msg.payload.time}}",
        "layout": "row-spread",
        "x": 580,
        "y": 400,
        "wires": []
    },
    {
        "id": "ef924eff.0b554",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "jsonata flowContext",
        "property": "payload.reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "$flowContext(\"reset\") + 1",
                "vt": "jsonata"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2410,
        "y": 920,
        "wires": [
            [
                "bb80923d.f484d"
            ]
        ]
    },
    {
        "id": "5b162a6.90479d4",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "リセットエリア",
        "property": "payload.kyori",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "$flowContext(\"radius\")/1000 ",
                "vt": "jsonata"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1720,
        "y": 1360,
        "wires": [
            [
                "e764579.34b67a8",
                "350256d7.ed678a"
            ]
        ]
    },
    {
        "id": "b7e6e8bb.d37cf8",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "@距離算出",
        "func": "function distance(lat1, lng1, lat2, lng2) {\n  lat1 *= Math.PI / 180;\n  lng1 *= Math.PI / 180;\n  lat2 *= Math.PI / 180;\n  lng2 *= Math.PI / 180;\n  dis = 6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2));\nreturn (Math.round(dis * 1000)) / 1000\n}\n\n\n\nmsg.payload={\n    lat:msg.payload.lat,\n    lon:msg.payload.lon,\n    latx:msg.payload.latx,\n    lony:msg.payload.lony,\n    kyori: distance(msg.payload.lat,msg.payload.lon,msg.payload.latx, msg.payload.lony),\n    //dir: dirc,\n    name: msg.payload.name,\n    //re_dir: redirection(msg.payload.latx, msg.payload.lony,msg.payload.lat,msg.payload.lon,msg.payload.bearing),\n    number:msg.payload.number,\n    reset:msg.payload.reset,\n    meter:msg.payload.meter,\n    bearing: msg.payload.bearing,\n    kukyori:msg.payload.kukyori,\n    //zenku:msg.payload.zenku,\n    approach:msg.payload.approach\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1530,
        "y": 1360,
        "wires": [
            [
                "5b162a6.90479d4"
            ]
        ]
    },
    {
        "id": "e764579.34b67a8",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "@角度",
        "func": "function distance(lat1, lng1, lat2, lng2) {\n  lat1 *= Math.PI / 180;\n  lng1 *= Math.PI / 180;\n  lat2 *= Math.PI / 180;\n  lng2 *= Math.PI / 180;\n  dis = 6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2));\nreturn (Math.round(dis * 1000)) / 1000\n}\n\nfunction direction(y1, x1, y2, x2) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI / 180;\n    x2 *= Math.PI / 180;\n    //x1 = Math.toRadians(x1);\n   // x2 = Math.toRadians(x2);\n   // y1 = Math.toRadians(y1);\n   // y2 = Math.toRadians(y2);\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n    //deg = Math.toDegrees(Math.atan2(a,b-c));\n    //angle = (deg + 360) % 360;\n    //return  (Math.abs(angle) + (1 / 7200));\n//return  90-Math.atan2( Math.sin(x2-x1), Math.cos(y1)*Math.tan(y2)-Math.sin(y1)*Math.cos(x2-x1));\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n//return  Math.atan2(a,b-c)*180/Math.PI;\n    if(dir<0){\n        dir=dir+360;\n    }\nreturn (Math.floor(dir*100)) / 100;\n}\n\nfunction redirection(y1, x1, y2, x2, bearing) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI /180;\n    x2 *= Math.PI / 180;\n    //x1 = Math.toRadians(x1);\n   // x2 = Math.toRadians(x2);\n   // y1 = Math.toRadians(y1);\n   // y2 = Math.toRadians(y2);\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n    //deg = Math.toDegrees(Math.atan2(a,b-c));\n    //angle = (deg + 360) % 360;\n    //return  (Math.abs(angle) + (1 / 7200));\n//return  90-Math.atan2( Math.sin(x2-x1), Math.cos(y1)*Math.tan(y2)-Math.sin(y1)*Math.cos(x2-x1));\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n//return  Math.atan2(a,b-c)*180/Math.PI;\n    if(dir<0){\n        dir=dir+360;\n    }\n    re_dir=dir-bearing;\n    if(re_dir<0){\n        re_dir=re_dir+360;\n    }\nreturn (Math.floor(re_dir*100)) / 100;\n}\n\n//function kmh(x) {\n//return (Math.round(x*3.6*100))/100;\n//}\ndirc=direction(msg.payload.lat, msg.payload.lon,msg.payload.latx,msg.payload.lony),\n\n\nmsg.payload={\n    //lat:msg.payload.lat,\n    //lon:msg.payload.lon,\n    //latx:msg.payload.latx,\n   // lony:msg.payload.lony,\n    kyori: msg.payload.kyori,\n    dir: dirc,\n    name: msg.payload.name,\n    //re_dir: redirection(msg.payload.latx, msg.payload.lony,msg.payload.lat,msg.payload.lon,msg.payload.bearing),\n    number:msg.payload.number,\n    reset:msg.payload.reset,\n    meter:msg.payload.meter,\n    bearing: msg.payload.bearing,\n    kukyori:msg.payload.kukyori,\n    //zenku:msg.payload.zenku,\n    approach:msg.payload.approach\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1670,
        "y": 1420,
        "wires": [
            [
                "a79d9c3c.733cc"
            ]
        ]
    },
    {
        "id": "a79d9c3c.733cc",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "角度差",
        "func": "function dir180(dir1,dir2) {\n    dir12=dir1-dir2;\n    if(dir12>180){\n    dir12=dir12-360;\n    }\nif(dir12<-180){\n        dir12=dir12+360;\n    }\n    return dir12;\n}\n//dirdir=msg.payload.dir-msg.payload.bearing;\n//if(dirdir>180){\n//    dirdir=dirdir-360;\n//    }\n//if(dirdir<-180){\n//        dirdir=dirdir+360;\n//    }\n    \nmsg.payload={\n    //dirdir:dirdir,\n    dirdir:dir180(msg.payload.dir,msg.payload.bearing),\n    approach:dir180(msg.payload.approach,msg.payload.bearing),\n    kyori:msg.payload.kyori,\n    name:msg.payload.name,\n    meter:msg.payload.meter,\n    reset:msg.payload.reset,\n    kukyori:msg.payload.kukyori,\n    number:msg.payload.number,\n    //lat:msg.payload.lat,\n    //lon:msg.payload.lon,\n    //zenku:msg.payload.zenku\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1810,
        "y": 1420,
        "wires": [
            [
                "320a356.933ceca"
            ]
        ]
    },
    {
        "id": "320a356.933ceca",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "進入角",
        "property": "payload.approach",
        "propertyType": "msg",
        "rules": [
            {
                "t": "btwn",
                "v": "-30",
                "vt": "num",
                "v2": "30",
                "v2t": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1670,
        "y": 1480,
        "wires": [
            [
                "8b77759.0b7d588"
            ]
        ]
    },
    {
        "id": "8b77759.0b7d588",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "リセット通過",
        "property": "payload.dirdir",
        "propertyType": "msg",
        "rules": [
            {
                "t": "btwn",
                "v": "-90",
                "vt": "num",
                "v2": "90",
                "v2t": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1820,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "bb80923d.f484d",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "flow.remain",
        "rules": [
            {
                "t": "set",
                "p": "remain",
                "pt": "flow",
                "to": "$floor(payload.kyori*1000)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "remain",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2390,
        "y": 860,
        "wires": [
            [
                "aced9699.40fc38"
            ]
        ]
    },
    {
        "id": "806fdc3c.7d996",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.time",
                "pt": "msg",
                "to": "",
                "tot": "date"
            },
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "delay",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2100,
        "y": 1480,
        "wires": [
            [
                "24981a3f.c9fbb6"
            ]
        ]
    },
    {
        "id": "24981a3f.c9fbb6",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "リセット",
        "func": "\nfunction TIME(time){\ndate = new Date(time);\nvar hh = (\"0\"+date.getHours()).slice(-2);\nvar mm = (\"0\"+date.getMinutes()).slice(-2);\nvar ss = (\"0\"+date.getSeconds()).slice(-2);\nvar mmm =(\"00\"+date.getMilliseconds()).slice(-3);\n\nreturn hh+\":\"+mm+\":\"+ss+\":\"+mmm;\n}\n\nfunction degToRad(degrees) {\n  return degrees * (Math.PI / 180);\n}\n\ndirdir=90-Math.abs(msg.payload.dirdir)\nrad=degToRad(dirdir);\ny=Math.sin(rad)*msg.payload.kyori*1000;//前後座標間距離\ny=Math.round(y*10)/10;\n//x=Math.round((flow.get(\"odd\")*10))/10;\nodd=flow.get(\"odd\");\ntotal=global.get(\"total\");\ncoe=global.get(\"coe\");\nj++;\nvar i=msg.payload.reset-1;\n\nif(flow.get(\"reset\") != i+1){\n//if(flow.get(\"odd\") >100){\n    flow.set(\"coe\",coe[i+1]);\n    flow.set(\"odd\",msg.payload.meter+y);\n    tst[i]=msg.payload.time;\n    time[i]=TIME(msg.payload.time);\n    \n    trip[i]=Math.round((odd-y)*100)/100;\n    if(msg.payload.meter==0){\n        error[i]=Math.round((trip[i]-kukyori)*100)/100;\n    }else{\n        error[i]=error[i]=Math.round((trip[i]-msg.payload.meter)*100)/100;\n    }\n    lap[i]=(TIME(tst[i]-tst[i-1]-9*60*60*1000)).slice(-9);\n}\n\ntrip[0]=j;\nflow.set(\"genku\",msg.payload.number);\nflow.set(\"reset\",msg.payload.reset);\nkukyori=msg.payload.kukyori;\nflow.set(\"kukyori\",kukyori);\n\nmsg.payload={\n    //dis:flow.get(\"odd\"),\n    //dis:msg.payload.meter,\n    name:msg.payload.name,\n    number:msg.payload.number,\n    kukyori:msg.payload.kukyori,\n    zenku:global.get(\"zenku\"),\n    trip:trip,\n    time:time,\n    lap:lap,\n    itrip:trip[i],\n    itime:TIME(msg.payload.time),\n    ilap:lap[i],\n    ku:i,\n    error:error,\n    lat:lat,\n    lon:lon,\n    dirdir:msg.payload.dirdir,\n    reset:msg.payload.reset,\n    //odd:msg.payload.meter+y,\n    odd:odd,\n    ody:y,\n}\n\nflow.set(\"trip\",trip);\nflow.set(\"error\",error);\nflow.set(\"time\",time);\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nflow.set(\"trip\" ,Array());\ntrip =Array();\nflow.set(\"error\",Array());\nerror=Array();\ntime=Array();\ntst=Array();\nlap=Array();\nlat=Array();\nlon=Array();\nj=0;",
        "finalize": "",
        "libs": [],
        "x": 2280,
        "y": 1500,
        "wires": [
            [
                "487bd37b.d2357c",
                "729f997.47daf68",
                "35604c7c.b53db4",
                "60bef771.85ea88",
                "e51aea7.d3c3d18",
                "8eedf7f1.a8fd28"
            ]
        ]
    },
    {
        "id": "66c68784.fb6158",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "手動リセット",
        "func": "var i=msg.payload.reset;\nx=global.get(\"ku\");\n//flow.set(\"odd\",0);\n\nmsg.payload={\n    meter:msg.payload.meter,\n    name:\"手動リセット\",\n    reset:i,\n    kukyori:x[i],\n    zenku:global.get(\"zenku\"),\n    kmh:0,\n    number:i,\n    dirdir:0,\n    kyori:0,\n\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1400,
        "y": 960,
        "wires": [
            [
                "fe055578.b9ce88",
                "5a3d574f.e4ff08"
            ]
        ]
    },
    {
        "id": "fe055578.b9ce88",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.dis",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 900,
        "wires": [
            [
                "c848b4a6.5a3658"
            ]
        ]
    },
    {
        "id": "cede26ac.6c91e8",
        "type": "ui_form",
        "z": "f20b3fe7.75306",
        "name": "",
        "label": "走距離修正",
        "group": "b90ab216.c29668",
        "order": 17,
        "width": 5,
        "height": 4,
        "options": [
            {
                "label": "区",
                "value": "reset",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "距離",
                "value": "meter",
                "type": "number",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "reset": "",
            "meter": ""
        },
        "payload": "",
        "submit": "submit",
        "cancel": "cancel",
        "topic": "",
        "topicType": "str",
        "splitLayout": false,
        "x": 1210,
        "y": 960,
        "wires": [
            [
                "66c68784.fb6158"
            ]
        ]
    },
    {
        "id": "33b85c07.92b6b4",
        "type": "switch",
        "z": "536d4aff.8b6084",
        "name": "pause",
        "property": "$parent.pause",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 530,
        "y": 80,
        "wires": [
            [
                "9b771e63.9b64d"
            ]
        ]
    },
    {
        "id": "54d68554.0c2bfc",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "flow.min",
        "property": "payload.speed",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "$flowContext(\"min\")/3.6 ",
                "vt": "jsonata"
            },
            {
                "t": "lt",
                "v": "$flowContext(\"min\")/3.6 ",
                "vt": "jsonata"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 120,
        "y": 640,
        "wires": [
            [
                "e9f75be9.d371f8"
            ],
            [
                "64401e3c.47b41"
            ]
        ]
    },
    {
        "id": "8e434a16.1a3558",
        "type": "change",
        "z": "536d4aff.8b6084",
        "name": "kmh",
        "rules": [
            {
                "t": "set",
                "p": "payload.kmh",
                "pt": "msg",
                "to": "$round(payload.kmh*100)/100",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 80,
        "wires": [
            [
                "33b85c07.92b6b4"
            ]
        ]
    },
    {
        "id": "151a8c97.1b9703",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "距離積算",
        "func": "flow.set(\"odd\",flow.get(\"odd\")+msg.payload.dis);\n//flow.set(\"odds\",flow.get(\"odd\"));\n//kukyori=global.get(\"ku\");\nkukyori=flow.get(\"kukyori\");\ngenku=flow.get(\"genku\");\n\nmsg.payload={\n    genku:genku,\n    zenku:global.get(\"zenku\"),\n    odd:(Math.floor(flow.get(\"odd\")*100)) / 100,\n    kukyori:kukyori,\n    kmh:msg.payload.kmh,\n    reset:flow.get(\"reset\"),\n    coe:flow.get(\"coe\"),\n    //kukyori:global.get(\"kukyori1\"),\n    //kukyori:kukyori[genku],\n}\n    \n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nflow.set(\"odd\",0);\nflow.set(\"coe\",1);\nflow.set(\"reset\",0);\nflow.set(\"genku\",0);\nflow.set(\"kukyori\",0);\nflow.set(\"oddt\",0);\n//kukyori=global.get(\"ku\");",
        "finalize": "",
        "libs": [],
        "x": 1660,
        "y": 460,
        "wires": [
            [
                "651cdb7.00e4624"
            ]
        ]
    },
    {
        "id": "c848b4a6.5a3658",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "delay",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 760,
        "wires": [
            [
                "e13bda8.47bd328"
            ]
        ]
    },
    {
        "id": "651cdb7.00e4624",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "総距離",
        "func": "i=flow.get(\"reset\")\ndate = new Date();\ntotal=global.get(\"total\");\nodd=flow.get(\"odd\");\n\nmsg.payload={\n    oddt:Math.floor(total[i]+odd),\n    odd:Math.floor(odd*10)/10,\n    remain:flow.get(\"remain\"),\n    kukyori:msg.payload.kukyori,\n    genku:flow.get(\"genku\"),\n    kmh:msg.payload.kmh,\n    time:Date.now(date),\n    //total:x[i-1],\n};\nreturn msg;\n\n//if(i==null){\n//    i=13;\n//    flow.set(\"genku\",13);\n//}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nflow.set(\"oddt\",0);\n//total=global.get(\"total\");\n//flow.set(\"genku\",1);\n//flow.set(\"oddt\",0);",
        "finalize": "",
        "libs": [],
        "x": 1870,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "f4aa4475.720a88",
        "type": "json",
        "z": "f20b3fe7.75306",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2390,
        "y": 680,
        "wires": [
            [
                "38a45995.86adc6"
            ]
        ]
    },
    {
        "id": "38a45995.86adc6",
        "type": "mqtt out",
        "z": "f20b3fe7.75306",
        "name": "",
        "topic": "trip1/odd",
        "qos": "0",
        "retain": "true",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "4646bf9b.55c01",
        "x": 2540,
        "y": 680,
        "wires": []
    },
    {
        "id": "729f997.47daf68",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "グローバル化",
        "rules": [
            {
                "t": "set",
                "p": "kukyori1",
                "pt": "global",
                "to": "payload.kukyori",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "genku1",
                "pt": "global",
                "to": "payload.number",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "odd1",
                "pt": "global",
                "to": "odd",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2560,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "4c65dae8.846464",
        "type": "file",
        "z": "f20b3fe7.75306",
        "name": "",
        "filename": "/home/pi/samba/public/reset1.log",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 3020,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "b9932be6.04c718",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload.trip",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.name",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "payload.zenku",
                "pt": "msg",
                "to": "zenku",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2780,
        "y": 1320,
        "wires": [
            [
                "ada202f9.85452"
            ]
        ]
    },
    {
        "id": "487bd37b.d2357c",
        "type": "template",
        "z": "f20b3fe7.75306",
        "name": "通過距離・時刻",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "リセット回数　{{payload.trip.0}} {{payload.time.0}}<br>\n１区　{{payload.trip.1}}m　{{payload.error.1}}　{{payload.time.1}}　{{payload.lap.1}}<br>\n２区　{{payload.trip.2}}m　{{payload.error.2}}　{{payload.time.2}}　{{payload.lap.2}}<br>\n３区　{{payload.trip.3}}m　{{payload.error.3}}　{{payload.time.3}}　{{payload.lap.3}}<br>\n４区　{{payload.trip.4}}m　{{payload.error.4}}　{{payload.time.4}}　{{payload.lap.4}}<br>\n５区　{{payload.trip.5}}m　{{payload.error.5}}　{{payload.time.5}}　{{payload.lap.5}}<br>\n６区　{{payload.trip.6}}m　{{payload.error.6}}　{{payload.time.6}}　{{payload.lap.6}}<br>\n７区　{{payload.trip.7}}m　{{payload.error.7}}　{{payload.time.7}}　{{payload.lap.7}}<br>\n８区　{{payload.trip.8}}m　{{payload.error.8}}　{{payload.time.8}}　{{payload.lap.8}}<br>\n９区　{{payload.trip.9}}m　{{payload.error.9}}　{{payload.time.9}}　{{payload.lap.9}}<br>\n10区　{{payload.trip.10}}m　{{payload.error.10}}　{{payload.time.10}}　{{payload.lap.10}}<br>\n11区　{{payload.trip.11}}m　{{payload.error.11}}　{{payload.time.11}}　{{payload.lap.11}}<br>\n12区　{{payload.trip.12}}m　{{payload.error.12}}　{{payload.time.12}}　{{payload.lap.12}}",
        "output": "str",
        "x": 2560,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "23d711a5.5b4c9e",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "msg.payload.trip",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.trip",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2780,
        "y": 1440,
        "wires": [
            [
                "4c65dae8.846464"
            ]
        ]
    },
    {
        "id": "740c1c3f.cdca54",
        "type": "delay",
        "z": "f20b3fe7.75306",
        "name": "シリアル遅延",
        "pauseType": "delayv",
        "timeout": "3000",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 2780,
        "y": 1380,
        "wires": [
            [
                "a53705e6.331008"
            ]
        ]
    },
    {
        "id": "a53705e6.331008",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "toシリアルデータ",
        "rules": [
            {
                "t": "set",
                "p": "kukyoris",
                "pt": "flow",
                "to": "kukyori1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "genkus",
                "pt": "flow",
                "to": "genku1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "odds",
                "pt": "flow",
                "to": "odd",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2970,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "ada202f9.85452",
        "type": "json",
        "z": "f20b3fe7.75306",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2950,
        "y": 1320,
        "wires": [
            [
                "e9eaf26f.dab29"
            ]
        ]
    },
    {
        "id": "35604c7c.b53db4",
        "type": "template",
        "z": "f20b3fe7.75306",
        "name": "距離誤差",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "0　{{payload.error.0}}<br>\n1　{{payload.error.1}}<br>\n2　{{payload.error.2}}<br>\n3　{{payload.error.3}}<br>\n4　{{payload.error.4}}<br>\n5　{{payload.error.5}}<br>\n6　{{payload.error.6}}<br>\n7　{{payload.error.7}}<br>\n8　{{payload.error.8}}<br>\n9　{{payload.error.9}}<br>\n10　{{payload.error.10}}<br>\n11　{{payload.error.11}}<br>\n12　{{payload.error.12}}",
        "output": "str",
        "x": 2540,
        "y": 1520,
        "wires": [
            []
        ]
    },
    {
        "id": "b0c40c50.5b596",
        "type": "ui_template",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "name": "誤差",
        "order": 16,
        "width": 3,
        "height": 5,
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2370,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "4ca0f792.bd4988",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "flow.imu",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "imu",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 1540,
        "wires": [
            []
        ]
    },
    {
        "id": "e5bdd833.ccfdc8",
        "type": "ui_switch",
        "z": "f20b3fe7.75306",
        "name": "",
        "label": "IMU",
        "tooltip": "",
        "group": "b90ab216.c29668",
        "order": 14,
        "width": 2,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 370,
        "y": 1540,
        "wires": [
            [
                "4ca0f792.bd4988"
            ]
        ]
    },
    {
        "id": "27a66d1e.4e85a2",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 210,
        "y": 1540,
        "wires": [
            [
                "e5bdd833.ccfdc8"
            ]
        ]
    },
    {
        "id": "b3ad18e3.b9ec78",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "imuスイッチ",
        "property": "imu",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 110,
        "y": 500,
        "wires": [
            [
                "7d33f3d2.f4640c"
            ],
            [
                "1616e587.6aa70a"
            ]
        ]
    },
    {
        "id": "7d33f3d2.f4640c",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "global.imu_gate",
        "property": "imu_gate",
        "propertyType": "global",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 320,
        "y": 500,
        "wires": [
            [
                "1616e587.6aa70a"
            ]
        ]
    },
    {
        "id": "87b16a92.d81c78",
        "type": "mqtt in",
        "z": "9d68a1c7.f4976",
        "name": "",
        "topic": "imu",
        "qos": "0",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 160,
        "y": 1200,
        "wires": [
            [
                "2ed72ba9.7cc7e4"
            ]
        ]
    },
    {
        "id": "2ed72ba9.7cc7e4",
        "type": "change",
        "z": "9d68a1c7.f4976",
        "name": "",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "imu_gate",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "260b791f.b4cdb6",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "true",
        "targetType": "full",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 370,
        "y": 1060,
        "wires": []
    },
    {
        "id": "4086ae91.7569d",
        "type": "catch",
        "z": "f20b3fe7.75306",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 160,
        "y": 1060,
        "wires": [
            [
                "260b791f.b4cdb6"
            ]
        ]
    },
    {
        "id": "9abb53f8.d2b2f",
        "type": "msg-size",
        "z": "f20b3fe7.75306",
        "name": "",
        "frequency": "min",
        "interval": 1,
        "statusContent": "tot",
        "estimation": false,
        "ignore": false,
        "pauseAtStartup": false,
        "humanReadableStatus": true,
        "x": 100,
        "y": 420,
        "wires": [
            [],
            [
                "b3ad18e3.b9ec78",
                "28068e36.4c17d2",
                "ccec0a3e.cb1d48"
            ]
        ]
    },
    {
        "id": "6af66162.2cec",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "NEXTリセット",
        "func": "\nx=global.get(\"reset\");\ni=flow.get(\"reset\");\n\nmsg.payload={\n    meter:x[i+1].meter,\n    name:\"手動　\"+x[i+1].name,\n    reset:i+1,\n    kukyori:x[i+1].kukyori,\n    zenku:global.get(\"zenku\"),\n    kmh:0,\n    number:x[i+1].number,\n    kyori:0,\n    dirdir:0,\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1400,
        "y": 900,
        "wires": [
            [
                "fe055578.b9ce88",
                "5a3d574f.e4ff08"
            ]
        ]
    },
    {
        "id": "11e9e1.b934961f",
        "type": "template",
        "z": "f20b3fe7.75306",
        "name": "現情報",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<font size=\"5\">{{payload.genku}}/{{payload.zenku}}区　1移動距離:{{payload.odd}}m/{{payload.kukyori}}m \n<br>総距離　{{payload.oddt}}ｍ　距離係数：{{payload.coe}}</font>",
        "output": "str",
        "x": 2190,
        "y": 620,
        "wires": [
            [
                "ef038eb5.6170a"
            ]
        ]
    },
    {
        "id": "692bae08.2efc3",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload.reset",
                "v": "0",
                "vt": "num"
            },
            {
                "p": "payload.meter",
                "v": "0",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "str",
        "x": 1050,
        "y": 960,
        "wires": [
            [
                "cede26ac.6c91e8"
            ]
        ]
    },
    {
        "id": "6b362e04.ad849",
        "type": "file",
        "z": "f20b3fe7.75306",
        "name": "",
        "filename": "/home/pi/samba/public/log1.csv",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 2650,
        "y": 1020,
        "wires": [
            []
        ]
    },
    {
        "id": "d0ba0fa5.7e635",
        "type": "csv",
        "z": "f20b3fe7.75306",
        "name": "",
        "sep": ",",
        "hdrin": "",
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 2370,
        "y": 1020,
        "wires": [
            [
                "6b362e04.ad849"
            ]
        ]
    },
    {
        "id": "ebdebaa0.b9af28",
        "type": "split",
        "z": "f20b3fe7.75306",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1910,
        "y": 880,
        "wires": [
            [
                "5e7554ca.c5832c"
            ]
        ]
    },
    {
        "id": "5e7554ca.c5832c",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "global.lat1",
        "rules": [
            {
                "t": "set",
                "p": "payload.latx",
                "pt": "msg",
                "to": "lat1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.lony",
                "pt": "msg",
                "to": "lon1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.bearing",
                "pt": "msg",
                "to": "bearing1",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1930,
        "y": 940,
        "wires": [
            [
                "5c8988f.8809878"
            ]
        ]
    },
    {
        "id": "ef038eb5.6170a",
        "type": "ui_template",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "name": "距離情報",
        "order": 4,
        "width": 8,
        "height": 2,
        "format": "<font size=\"4\"><div ng-bind-html=\"msg.payload\"></div></font>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2360,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "f6e54a8f.30ab98",
        "type": "exec",
        "z": "9d68a1c7.f4976",
        "command": "gpsd -N udp://*:29998",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 390,
        "y": 1360,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "68ba2ee3.5111f",
        "type": "inject",
        "z": "9d68a1c7.f4976",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 1360,
        "wires": [
            [
                "f6e54a8f.30ab98"
            ]
        ]
    },
    {
        "id": "ebaa16eb.fed148",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 550,
        "y": 340,
        "wires": []
    },
    {
        "id": "923fce22.cd2f6",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "odd1t",
        "rules": [
            {
                "t": "set",
                "p": "odd1t",
                "pt": "global",
                "to": "payload.oddt",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2270,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "64401e3c.47b41",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.kmh",
                "pt": "msg",
                "to": "msg.payload.speed*3.6",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.dis",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 140,
        "y": 760,
        "wires": [
            [
                "b2f9fa84.8eb638"
            ]
        ]
    },
    {
        "id": "62ccbb50.f90844",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "isNaN",
        "func": "if (isNaN(msg.payload.oddt)) {\n    msg.payload.oddt=0;\n  }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2410,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "ec9c7841.f68298",
        "type": "ui_dropdown",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "label": "駅伝/マラソン",
        "tooltip": "",
        "place": "Select option",
        "group": "4a48ee78.c45ed",
        "order": 1,
        "width": 5,
        "height": 1,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "駅伝",
                "value": 1,
                "type": "num"
            },
            {
                "label": "マラソン",
                "value": 2,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "x": 320,
        "y": 60,
        "wires": [
            [
                "d71aaeb2.bd3ab"
            ]
        ]
    },
    {
        "id": "d71aaeb2.bd3ab",
        "type": "change",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "em",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "77cbba99.231774",
        "type": "inject",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "em",
        "payloadType": "global",
        "x": 100,
        "y": 60,
        "wires": [
            [
                "ec9c7841.f68298"
            ]
        ]
    },
    {
        "id": "5bbabff7.7c3c9",
        "type": "csv",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 470,
        "y": 160,
        "wires": [
            [
                "2dee9f39.82c15"
            ]
        ]
    },
    {
        "id": "6c299e81.44f1e",
        "type": "file in",
        "z": "90be64ef.6b4fc8",
        "name": "fukuoka.csv",
        "filename": "/home/pi/samba/public/fukuoka.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 310,
        "y": 160,
        "wires": [
            [
                "5bbabff7.7c3c9"
            ]
        ]
    },
    {
        "id": "27529622.5c066a",
        "type": "change",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "base",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "af225bc9.03cb58",
        "type": "inject",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 160,
        "wires": [
            [
                "6c299e81.44f1e"
            ]
        ]
    },
    {
        "id": "b246a674.ba1868",
        "type": "join",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 1010,
        "y": 200,
        "wires": [
            [
                "27529622.5c066a"
            ]
        ]
    },
    {
        "id": "461b633.062869c",
        "type": "switch",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "property": "payload.number",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "1000",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "1000",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 810,
        "y": 160,
        "wires": [
            [
                "928fa098.bfbbf",
                "ab7ec23b.07941"
            ],
            [
                "b246a674.ba1868"
            ]
        ]
    },
    {
        "id": "ab7ec23b.07941",
        "type": "join",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "mode": "custom",
        "build": "array",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": false,
        "timeout": "1",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 1010,
        "y": 140,
        "wires": [
            [
                "db9a1ce9.2ee46"
            ]
        ]
    },
    {
        "id": "db9a1ce9.2ee46",
        "type": "change",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 140,
        "wires": [
            [
                "53cf6ec.aae3f9",
                "47974e05.56b0c"
            ]
        ]
    },
    {
        "id": "53cf6ec.aae3f9",
        "type": "function",
        "z": "90be64ef.6b4fc8",
        "name": "global.total",
        "func": "x=global.get(\"reset\");\n\nfor(i=1;i<=global.get(\"reset_q\");i++){\n    if(x[i].meter==0){\n        total[i]=total[i-1]+x[i-1].kukyori;\n        to=total[i];\n    }\n    else{\n    total[i]=total[i-1];    \n    }\n    \n    ku[x[i].number]=x[i].kukyori;\n    //ku[i]=x[i-1].kukyori;\n    coe[i]=x[i].coefficient;\n}\nglobal.set(\"total\",total);\nglobal.set(\"ku\",ku);\nglobal.set(\"coe\",coe);\nmsg.payload={\n    total:total,\n    ku:ku,\n    coe:coe,\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\ntotal=Array();\nku=Array();\ncoe=Array();\ntotal[0]=0;\ncoe[0]=1;\nku[0]=0;",
        "finalize": "",
        "libs": [],
        "x": 1370,
        "y": 140,
        "wires": [
            [
                "f21c9e9.65e906"
            ]
        ]
    },
    {
        "id": "928fa098.bfbbf",
        "type": "function",
        "z": "90be64ef.6b4fc8",
        "name": "全区セット",
        "func": "x=msg.payload.number;\ny=msg.payload.reset;\nif(x > zenku){\n    //zenku=x;\n    zenku=x;\n}\nif(y > no){\n    no=y;\n}\nglobal.set(\"zenku\",zenku-1);\nglobal.set(\"reset_q\",no);\nmsg.payload={\n    zenku:zenku-1,\n    no:no\n}\n//msg.payload=x;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nzenku=0;\nno=0;\n//global.set(\"genku1\",0)",
        "finalize": "",
        "libs": [],
        "x": 1030,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "5a85bf9b.12be6",
        "type": "ui_text",
        "z": "90be64ef.6b4fc8",
        "group": "4a48ee78.c45ed",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "nodered start time",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 790,
        "y": 380,
        "wires": []
    },
    {
        "id": "cc4d201c.0c31b",
        "type": "change",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "start",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 380,
        "wires": [
            [
                "ea6e164f.38f548"
            ]
        ]
    },
    {
        "id": "ea6e164f.38f548",
        "type": "moment",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "topic": "",
        "input": "",
        "inputType": "msg",
        "inTz": "Asia/Tokyo",
        "adjAmount": "9",
        "adjType": "hours",
        "adjDir": "add",
        "format": "",
        "locale": "ja-JP",
        "output": "",
        "outputType": "msg",
        "outTz": "Asia/Tokyo",
        "x": 560,
        "y": 380,
        "wires": [
            [
                "5a85bf9b.12be6"
            ]
        ]
    },
    {
        "id": "6d263696.9d0198",
        "type": "inject",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 380,
        "wires": [
            [
                "cc4d201c.0c31b"
            ]
        ]
    },
    {
        "id": "b8c01e7f.583a1",
        "type": "ui_numeric",
        "z": "9d68a1c7.f4976",
        "name": "",
        "label": "accurate",
        "tooltip": "",
        "group": "693bf46.1e1860c",
        "order": 17,
        "width": 3,
        "height": 1,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "step": "10",
        "x": 120,
        "y": 980,
        "wires": [
            [
                "d1366209.cf0a1"
            ]
        ]
    },
    {
        "id": "d1366209.cf0a1",
        "type": "function",
        "z": "9d68a1c7.f4976",
        "name": "owntracksコマンド作成",
        "func": "msg.payload={\n    _type:\"cmd\",\n    action: \"setConfiguration\",\n    configuration:{\n        _type: \"configuration\",\n        //moveModeLocatorInterval:1,\n        //locatorPriority:msg.payload, \n        ignoreInaccurateLocations:msg.payload,\n        //extendedData:false,\n        //pubRetain:true,\n        //pubQos :0,\n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 980,
        "wires": [
            [
                "670e1ed4.e77ed"
            ]
        ]
    },
    {
        "id": "bcda37aa.9c23e8",
        "type": "debug",
        "z": "9d68a1c7.f4976",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 1020,
        "wires": []
    },
    {
        "id": "e9eaf26f.dab29",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 3130,
        "y": 1320,
        "wires": []
    },
    {
        "id": "6aad71c3.bf96b",
        "type": "cast-to-client",
        "z": "f20b3fe7.75306",
        "name": "",
        "url": "",
        "contentType": "",
        "message": "もうすぐお父さんが、帰ってきます。",
        "language": "ja",
        "ip": "192.168.24.10",
        "port": "8009",
        "volume": "",
        "x": 2710,
        "y": 960,
        "wires": [
            []
        ]
    },
    {
        "id": "48d34597.e03bbc",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "",
        "property": "payload.reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "12",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2370,
        "y": 960,
        "wires": [
            [
                "6aad71c3.bf96b"
            ]
        ]
    },
    {
        "id": "281c7615.9c8a5a",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2680,
        "y": 900,
        "wires": [
            [
                "6aad71c3.bf96b"
            ]
        ]
    },
    {
        "id": "4c68a25a.02dabc",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 270,
        "y": 1180,
        "wires": [
            [
                "7a95fa74.9bada4"
            ]
        ]
    },
    {
        "id": "82ac59ce.2ed2f8",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 2030,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "f541fc77.157f4",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "NaN対策",
        "props": [
            {
                "p": "payload.odd",
                "v": "0",
                "vt": "num"
            },
            {
                "p": "payload.oddt",
                "v": "0",
                "vt": "num"
            },
            {
                "p": "payload.remain",
                "v": "0",
                "vt": "num"
            },
            {
                "p": "payload.genku",
                "v": "1",
                "vt": "num"
            },
            {
                "p": "payload.kukyori",
                "v": "9999",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "str",
        "x": 2040,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "28b162bf.91482e",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "remain",
                "pt": "flow",
                "to": "payload.remain",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2320,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "a0410efb.c3bc7",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 1340,
        "wires": []
    },
    {
        "id": "d1ec4eb2.66e0f",
        "type": "trigger",
        "z": "f20b3fe7.75306",
        "name": "",
        "op1": "true",
        "op2": "0",
        "op1type": "bool",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "0",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 280,
        "y": 1320,
        "wires": [
            [
                "a0410efb.c3bc7",
                "7a95fa74.9bada4"
            ]
        ]
    },
    {
        "id": "8f7f03fe.1577a",
        "type": "trigger",
        "z": "f20b3fe7.75306",
        "name": "",
        "op1": "false",
        "op2": "0",
        "op1type": "bool",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "1",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 280,
        "y": 1360,
        "wires": [
            [
                "a0410efb.c3bc7",
                "7a95fa74.9bada4"
            ]
        ]
    },
    {
        "id": "350256d7.ed678a",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1910,
        "y": 1360,
        "wires": []
    },
    {
        "id": "3bb502f.43d3bfe",
        "type": "ui_text_input",
        "z": "f20b3fe7.75306",
        "name": "",
        "label": "リセットポイント半径",
        "tooltip": "リセットポイント半径",
        "group": "b90ab216.c29668",
        "order": 15,
        "width": 3,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "topic",
        "topicType": "msg",
        "x": 420,
        "y": 1600,
        "wires": [
            [
                "426a66c1.556f28"
            ]
        ]
    },
    {
        "id": "426a66c1.556f28",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "radius",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 1600,
        "wires": [
            []
        ]
    },
    {
        "id": "5f59b43d.b1ea9c",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "15",
        "payloadType": "num",
        "x": 210,
        "y": 1600,
        "wires": [
            [
                "3bb502f.43d3bfe"
            ]
        ]
    },
    {
        "id": "6196f8f9.e8b218",
        "type": "ui_dropdown",
        "z": "975620f5.ba38",
        "name": "",
        "label": "シリアル出力セレクト",
        "tooltip": "",
        "place": "Select option",
        "group": "4a48ee78.c45ed",
        "order": 3,
        "width": 5,
        "height": 1,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "1号車",
                "value": 1,
                "type": "num"
            },
            {
                "label": "2号車",
                "value": 2,
                "type": "num"
            },
            {
                "label": "3号車",
                "value": 3,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "topicType": "str",
        "x": 120,
        "y": 240,
        "wires": [
            [
                "4eefa4e0.f2ff0c"
            ]
        ]
    },
    {
        "id": "4eefa4e0.f2ff0c",
        "type": "change",
        "z": "975620f5.ba38",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "car",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "9054017e.ca419",
        "type": "ui_text_input",
        "z": "975620f5.ba38",
        "name": "",
        "label": "シリアル遅延(m/s）",
        "tooltip": "",
        "group": "4a48ee78.c45ed",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "",
        "x": 120,
        "y": 200,
        "wires": [
            [
                "8e060ea1.ed827"
            ]
        ]
    },
    {
        "id": "8e060ea1.ed827",
        "type": "change",
        "z": "975620f5.ba38",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "6de4bae7.ff8fa4",
        "type": "delay",
        "z": "f20b3fe7.75306",
        "name": "シリアル遅延",
        "pauseType": "delayv",
        "timeout": "3000",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 2360,
        "y": 800,
        "wires": [
            [
                "201c8788.dc67c8"
            ]
        ]
    },
    {
        "id": "201c8788.dc67c8",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "GETシリアルデータ",
        "func": "msg.payload={\n    car:global.get(\"car\"),\n    em:global.get(\"em\"),\n    zenku:msg.payload.zenku,\n    genku:msg.payload.genku,\n    kukyori:msg.payload.kukyori,\n    kyori:msg.payload.odd,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2580,
        "y": 800,
        "wires": [
            [
                "6037165c.3de478",
                "4560ed4d.5b7034"
            ]
        ]
    },
    {
        "id": "6037165c.3de478",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "シリアル作成",
        "func": "\n    \n    hexi[1]=msg.payload.em;\n    hexi[0]=msg.payload.car;\nHEX[1]=(hexi[0]<<4) +hexi[1];    \n    \n    value=msg.payload.zenku;\n    hexi[3]= (value % 10); value /= 10;\n    hexi[2]= (value % 10); value /= 10;\nHEX[2]=(hexi[2]<<4)+hexi[3];      \n    \n    value=msg.payload.genku;\n    hexi[5]= (value % 10); value /= 10;\n    hexi[4]= (value % 10); value /= 10;\nHEX[3]=(hexi[4]<<4)+hexi[5];      \n      \n    value=msg.payload.kukyori;\n    hexi[11]= (value % 10); value /= 10;\n    hexi[10]= (value % 10); value /= 10;\n    hexi[9]= (value % 10); value /= 10;\n    hexi[8]= (value % 10); value /= 10;\n    hexi[7]= (value % 10); value /= 10;\n    hexi[6]= (value % 10); value /= 10;\nHEX[4]=(hexi[6]<<4) +hexi[7];\nHEX[5]=(hexi[8]<<4) +hexi[9];\nHEX[6]=(hexi[10]<<4) +hexi[11];\n\n    value=msg.payload.kyori;\n    hexi[17]= (value % 10); value /= 10;\n    hexi[16]= (value % 10); value /= 10;\n    hexi[15]= (value % 10); value /= 10;\n    hexi[14]= (value % 10); value /= 10;\n    hexi[13]= (value % 10); value /= 10;\n    hexi[12]= (value % 10); value /= 10;\nHEX[7]=(hexi[12]<<4) +hexi[13];\nHEX[8]=(hexi[14]<<4) +hexi[15];\nHEX[9]=(hexi[16]<<4) +hexi[17];\n    chk=0;\n    for(k=1; k<=9;k++){\n        chk=chk+HEX[k];\n    }   \n    chk=chk&255;\n    ck1=chk>>4;\n    ck2=chk&15;\nHEX[10]=ck1;\nHEX[11]=ck2;         \n      \nmsg.payload=HEX;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nHEX =new Buffer(13);\nhexi =new Buffer(18);\nHEX[0]=0xaa;\nHEX[12]=0xbb;\n",
        "finalize": "",
        "x": 2840,
        "y": 800,
        "wires": [
            [
                "9c5a894.d26cd78"
            ]
        ]
    },
    {
        "id": "9c5a894.d26cd78",
        "type": "serial out",
        "z": "f20b3fe7.75306",
        "name": "",
        "serial": "665ac286.d04e5c",
        "x": 3030,
        "y": 800,
        "wires": []
    },
    {
        "id": "d1086772.24d218",
        "type": "switch",
        "z": "f20b3fe7.75306",
        "name": "",
        "property": "car",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2190,
        "y": 800,
        "wires": [
            [
                "6de4bae7.ff8fa4"
            ]
        ]
    },
    {
        "id": "60bef771.85ea88",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload.zenku",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.trip",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.time",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.lap",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.ku",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.error",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.lat",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.lon",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "payload.dis",
                "pt": "msg",
                "to": "odd",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2560,
        "y": 1320,
        "wires": [
            []
        ]
    },
    {
        "id": "2dee9f39.82c15",
        "type": "change",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "parts",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 160,
        "wires": [
            [
                "461b633.062869c"
            ]
        ]
    },
    {
        "id": "375ee4f4.e5f54c",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "ダミー",
        "func": "msg.payload={\n    dis:12,\n    track: 90,\n    lat: 33.5928703,\n    lon: 130.3509459,\n    latx:33.59287031,\n    lony:130.3509460,\n    tst: 1624950665000,\n    tstd: 1624950665250,\n    alt: 10,\n    altd: 9,\n    //device: msg.payload.device,\n    //speed:msg.payload.speed,\n    kmh:10,\n    //kmh: Math.round((msg.payload.speed*3.6*100))/100,\n    climb: msg.payload.climb,\n    acc:msg.payload.acc,\n    };\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 210,
        "y": 820,
        "wires": [
            [
                "b2f9fa84.8eb638"
            ]
        ]
    },
    {
        "id": "c38f31b2.baff2",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 900,
        "wires": [
            [
                "375ee4f4.e5f54c"
            ]
        ]
    },
    {
        "id": "303aa38a.a5de7c",
        "type": "inject",
        "z": "df06f9b1.fe75f8",
        "name": "おやすみ",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "55 20 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 100,
        "wires": [
            [
                "2539cbb8.7e8a34"
            ]
        ]
    },
    {
        "id": "49a74f74.dba1e",
        "type": "change",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 880,
        "y": 480,
        "wires": [
            [
                "baaafa7f.ac74b8"
            ]
        ]
    },
    {
        "id": "b74f199d.ee4458",
        "type": "link out",
        "z": "f20b3fe7.75306",
        "name": "",
        "links": [
            "ddab066c.9d8188",
            "dfa3b187.7efc"
        ],
        "x": 455,
        "y": 820,
        "wires": []
    },
    {
        "id": "2539cbb8.7e8a34",
        "type": "random",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "low": 1,
        "high": "98",
        "inte": "true",
        "property": "payload",
        "x": 280,
        "y": 100,
        "wires": [
            [
                "7822cfd5.3086c",
                "895a62bc.9ba3a"
            ]
        ]
    },
    {
        "id": "7822cfd5.3086c",
        "type": "switch",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "property": "$number(payload)%2\t",
        "propertyType": "jsonata",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 480,
        "y": 100,
        "wires": [
            [
                "1a4bac5e.b19c54"
            ],
            [
                "af6ab9e5.33bb68"
            ]
        ]
    },
    {
        "id": "af6ab9e5.33bb68",
        "type": "cast-to-client",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "url": "",
        "contentType": "",
        "message": "名島海岸にゴジラ出現、アリストグレート、緊急出動にゃん",
        "language": "ja",
        "ip": "192.168.24.10",
        "port": "8009",
        "volume": "",
        "x": 710,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "895a62bc.9ba3a",
        "type": "debug",
        "z": "df06f9b1.fe75f8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 350,
        "y": 220,
        "wires": []
    },
    {
        "id": "69c170a0.79b08",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2830,
        "y": 860,
        "wires": []
    },
    {
        "id": "aced9699.40fc38",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "GPS逆算距離",
        "func": "genku=flow.get(\"genku\");\nku=global.get(\"ku\");\nremain=msg.payload;\nmsg.payload={\n    oddr:ku[genku]-remain,\n    remain:remain,\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nku=Array()",
        "finalize": "",
        "libs": [],
        "x": 2620,
        "y": 860,
        "wires": [
            [
                "69c170a0.79b08"
            ]
        ]
    },
    {
        "id": "9b771e63.9b64d",
        "type": "switch",
        "z": "536d4aff.8b6084",
        "name": "flow.min",
        "property": "payload.kmh",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "$parent.min",
                "vt": "flow"
            },
            {
                "t": "lt",
                "v": "$parent.min",
                "vt": "flow"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 680,
        "y": 80,
        "wires": [
            [
                "84b8dd27.abd21"
            ],
            []
        ]
    },
    {
        "id": "7123cfee.e61d7",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 130,
        "y": 280,
        "wires": []
    },
    {
        "id": "8a38fec1.4e7bf",
        "type": "alexa-home",
        "z": "df06f9b1.fe75f8",
        "conf": "c3624d3c.be7fe",
        "device": "147280",
        "acknoledge": true,
        "name": "お風呂",
        "topic": "お風呂",
        "x": 110,
        "y": 480,
        "wires": [
            [
                "b9374d55.c57ae"
            ]
        ]
    },
    {
        "id": "f21c9e9.65e906",
        "type": "debug",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1580,
        "y": 140,
        "wires": []
    },
    {
        "id": "baaafa7f.ac74b8",
        "type": "alexa-home-resp",
        "z": "df06f9b1.fe75f8",
        "x": 1140,
        "y": 480,
        "wires": []
    },
    {
        "id": "754ce382.19c90c",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "受信間隔測定",
        "func": "date = new Date();\ntime=Date.now(date)\nmsg.payload=time-pre_time;\npre_time=time;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\npre_time=0",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 340,
        "wires": [
            [
                "ebaa16eb.fed148"
            ]
        ]
    },
    {
        "id": "7da66365.02947c",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "zenku&誤差付加",
        "rules": [
            {
                "t": "set",
                "p": "payload.zenku",
                "pt": "msg",
                "to": "zenku",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.epx",
                "pt": "msg",
                "to": "epx1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.epy",
                "pt": "msg",
                "to": "epy1",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2220,
        "y": 680,
        "wires": [
            [
                "f4aa4475.720a88"
            ]
        ]
    },
    {
        "id": "596d7ca3.b682d4",
        "type": "file in",
        "z": "90be64ef.6b4fc8",
        "name": "fukuoka.csv",
        "filename": "/home/pi/samba/public/fukuoka.csv",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 310,
        "y": 240,
        "wires": [
            [
                "128caa6d.7cc306"
            ]
        ]
    },
    {
        "id": "128caa6d.7cc306",
        "type": "csv",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "sep": ",",
        "hdrin": true,
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": false,
        "include_null_values": true,
        "x": 470,
        "y": 240,
        "wires": [
            [
                "f1fe3774.4d8a58"
            ]
        ]
    },
    {
        "id": "f1fe3774.4d8a58",
        "type": "change",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "parts",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 240,
        "wires": [
            [
                "7a9fae8b.356d"
            ]
        ]
    },
    {
        "id": "9996d99c.d9c058",
        "type": "inject",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 240,
        "wires": [
            [
                "596d7ca3.b682d4"
            ]
        ]
    },
    {
        "id": "7a9fae8b.356d",
        "type": "mqtt out",
        "z": "90be64ef.6b4fc8",
        "name": "地点配信",
        "topic": "pointdata",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "4646bf9b.55c01",
        "x": 880,
        "y": 240,
        "wires": []
    },
    {
        "id": "33a6bda2.2bcf92",
        "type": "mqtt in",
        "z": "8caaa155.e5486",
        "name": "",
        "topic": "owntracks/nodered/aquos",
        "qos": "0",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 130,
        "y": 40,
        "wires": [
            [
                "235ebb81.276a44"
            ]
        ]
    },
    {
        "id": "8705f39c.f2825",
        "type": "template",
        "z": "8caaa155.e5486",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "時速 : {{payload.kmh}} km",
        "output": "str",
        "x": 700,
        "y": 500,
        "wires": [
            [
                "8348c670.545b78"
            ]
        ]
    },
    {
        "id": "8348c670.545b78",
        "type": "ui_template",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "name": "Speed",
        "order": 6,
        "width": 3,
        "height": 1,
        "format": "<font size=\"5\"><div ng-bind-html=\"msg.payload\"> </div></font> ",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 850,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "26100445.94575c",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "新距離積算",
        "func": "flow.set(\"odd\",flow.get(\"odd\")+msg.payload.dis);\n//flow.set(\"odds\",flow.get(\"odd\"));\n//kukyori=global.get(\"ku\");\nkukyori=flow.get(\"kukyori\");\ngenku=flow.get(\"genku\");\ni=flow.get(\"reset\")\ndate = new Date();\ntotal=global.get(\"total\");\nodd=(Math.floor(flow.get(\"odd\")*100)) / 100;\n\nmsg.payload={\n    genku:genku,\n    zenku:global.get(\"zenku\"),\n    odd:odd,\n    kukyori:kukyori,\n    kmh:msg.payload.kmh,\n    reset:i,\n    coe:flow.get(\"coe\"),\n    oddt:Math.floor(total[i]+odd),\n    remain:flow.get(\"remain\"),\n    time:Date.now(date),\n}\n    \n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nflow.set(\"odd\",0);\nflow.set(\"coe\",1);\nflow.set(\"reset\",0);\nflow.set(\"genku\",0);\nflow.set(\"kukyori\",0);\n//kukyori=global.get(\"ku\");",
        "finalize": "",
        "libs": [],
        "x": 2010,
        "y": 420,
        "wires": [
            [
                "4af1162e.d67838",
                "bd306c8.116a19",
                "c8121a60.15c898",
                "ad03a42.31b8e58",
                "51859961.73b548",
                "b3ffa02a.fd77a",
                "d5389993.d31f38"
            ]
        ]
    },
    {
        "id": "99554bb0.842358",
        "type": "ui_button",
        "z": "8caaa155.e5486",
        "name": "",
        "group": "693bf46.1e1860c",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "リセット",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "",
        "x": 1220,
        "y": 500,
        "wires": [
            [
                "5be61e6f.1fa6b"
            ]
        ]
    },
    {
        "id": "9124b716.e71978",
        "type": "mqtt in",
        "z": "8caaa155.e5486",
        "name": "",
        "topic": "trip3/zero",
        "qos": "2",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": false,
        "x": 1220,
        "y": 360,
        "wires": [
            [
                "a7446ddf.b303"
            ]
        ]
    },
    {
        "id": "d8bd23a1.c0f91",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 430,
        "y": 500,
        "wires": []
    },
    {
        "id": "3017875f.bc5758",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "true/false",
        "func": "context.flow.move = !context.flow.move;\nmsg.payload = context.flow.move;\n//if(context,flow.move == false){\n//    flow.set(\"tstd\",null);\n//    flow.set(\"latx\",null);\n//    flow.set(\"lony\",null);\n//}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\n//context.flow.move==true",
        "finalize": "",
        "x": 320,
        "y": 920,
        "wires": [
            [
                "a791c927.1fa628"
            ]
        ]
    },
    {
        "id": "e6b59bd3.b56578",
        "type": "mqtt in",
        "z": "8caaa155.e5486",
        "name": "",
        "topic": "trip3/pause",
        "qos": "2",
        "datatype": "auto",
        "broker": "ac7569b4.5ada88",
        "x": 330,
        "y": 1000,
        "wires": [
            [
                "a791c927.1fa628"
            ]
        ]
    },
    {
        "id": "5a48c71a.7b1928",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 790,
        "y": 920,
        "wires": [
            [
                "fc16026a.7e2aa"
            ],
            [
                "fadeb142.b7d13"
            ]
        ]
    },
    {
        "id": "6eba8fa5.205f7",
        "type": "ui_button",
        "z": "8caaa155.e5486",
        "name": "PAUSE",
        "group": "693bf46.1e1860c",
        "order": 1,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "{{msg.topic}}",
        "tooltip": "",
        "color": "",
        "bgcolor": " {{msg.background}}",
        "icon": "",
        "payload": "",
        "payloadType": "date",
        "topic": "",
        "topicType": "str",
        "x": 136.1180419921875,
        "y": 919.1111450195312,
        "wires": [
            [
                "3017875f.bc5758"
            ]
        ]
    },
    {
        "id": "a791c927.1fa628",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "pause",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 920,
        "wires": [
            [
                "5a48c71a.7b1928"
            ]
        ]
    },
    {
        "id": "fc16026a.7e2aa",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "red",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "計測中",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1000,
        "y": 860,
        "wires": [
            [
                "6eba8fa5.205f7"
            ]
        ]
    },
    {
        "id": "fadeb142.b7d13",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "blue",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "PAUSE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1000,
        "y": 980,
        "wires": [
            [
                "6eba8fa5.205f7"
            ]
        ]
    },
    {
        "id": "bc404d75.55b9b",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "limit",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 1140,
        "wires": [
            [
                "c82cbe8c.b93da"
            ]
        ]
    },
    {
        "id": "bb5be9fb.cf1168",
        "type": "ui_slider",
        "z": "8caaa155.e5486",
        "name": "",
        "label": "最低速度",
        "tooltip": "",
        "group": "693bf46.1e1860c",
        "order": 11,
        "width": 6,
        "height": 1,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "min": 0,
        "max": "5",
        "step": "0.2",
        "x": 320,
        "y": 1200,
        "wires": [
            [
                "782e6cad.62f844"
            ]
        ]
    },
    {
        "id": "68031ade.c978c4",
        "type": "ui_text",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "order": 10,
        "width": 2,
        "height": 1,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}ｋｍ",
        "layout": "row-spread",
        "x": 730,
        "y": 1200,
        "wires": []
    },
    {
        "id": "e66f566a.892a98",
        "type": "ui_slider",
        "z": "8caaa155.e5486",
        "name": "",
        "label": "速度制限",
        "tooltip": "",
        "group": "693bf46.1e1860c",
        "order": 13,
        "width": 6,
        "height": 1,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "min": "10",
        "max": "180",
        "step": "10",
        "x": 320,
        "y": 1140,
        "wires": [
            [
                "bc404d75.55b9b"
            ]
        ]
    },
    {
        "id": "c82cbe8c.b93da",
        "type": "ui_text",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "order": 12,
        "width": 2,
        "height": 1,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}ｋｍ",
        "layout": "row-spread",
        "x": 730,
        "y": 1140,
        "wires": []
    },
    {
        "id": "782e6cad.62f844",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "min",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 1200,
        "wires": [
            [
                "68031ade.c978c4"
            ]
        ]
    },
    {
        "id": "ed7da24b.b18b8",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "global3移動",
        "rules": [
            {
                "t": "set",
                "p": "lat3",
                "pt": "global",
                "to": "payload.lat",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "lon3",
                "pt": "global",
                "to": "payload.lon",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "name3",
                "pt": "global",
                "to": "payload.name",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "bearing3",
                "pt": "global",
                "to": "payload.bearing",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iconColor3",
                "pt": "global",
                "to": "payload.iconColor",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload.color",
                "pt": "msg",
                "to": "color3",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "4af1162e.d67838",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "odd3",
                "pt": "global",
                "to": "payload.dis",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2260,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "89d7a63a.067e58",
        "type": "inject",
        "z": "8caaa155.e5486",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "100",
        "payloadType": "num",
        "x": 130,
        "y": 1140,
        "wires": [
            [
                "e66f566a.892a98"
            ]
        ]
    },
    {
        "id": "6d2f51eb.bd737",
        "type": "inject",
        "z": "8caaa155.e5486",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 130,
        "y": 1200,
        "wires": [
            [
                "bb5be9fb.cf1168"
            ]
        ]
    },
    {
        "id": "3ff606bb.8f82da",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "true",
        "targetType": "full",
        "statusVal": "payload",
        "statusType": "auto",
        "x": 430,
        "y": 680,
        "wires": []
    },
    {
        "id": "8cffdc09.e7e15",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "flow.imu",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "imu",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 1280,
        "wires": [
            []
        ]
    },
    {
        "id": "e4fcdf00.3b92c",
        "type": "ui_switch",
        "z": "8caaa155.e5486",
        "name": "",
        "label": "IMU",
        "tooltip": "",
        "group": "693bf46.1e1860c",
        "order": 14,
        "width": 2,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 330,
        "y": 1280,
        "wires": [
            [
                "8cffdc09.e7e15"
            ]
        ]
    },
    {
        "id": "9fa60036.ca672",
        "type": "catch",
        "z": "8caaa155.e5486",
        "name": "",
        "scope": null,
        "uncaught": false,
        "x": 200,
        "y": 680,
        "wires": [
            [
                "3ff606bb.8f82da"
            ]
        ]
    },
    {
        "id": "506b1a5d.d5ed44",
        "type": "inject",
        "z": "8caaa155.e5486",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 130,
        "y": 1280,
        "wires": [
            [
                "e4fcdf00.3b92c"
            ]
        ]
    },
    {
        "id": "90008b42.fe1848",
        "type": "ui_text_input",
        "z": "8caaa155.e5486",
        "name": "",
        "label": "3距離補正",
        "tooltip": "",
        "group": "693bf46.1e1860c",
        "order": 3,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "",
        "x": 1230,
        "y": 300,
        "wires": [
            [
                "1114b4ec.cafbdb"
            ]
        ]
    },
    {
        "id": "157a03ab.0e6b3c",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "isNaN",
        "func": "if (isNaN(msg.payload)) {\n    msg.payload=0;\n  }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 330,
        "y": 1080,
        "wires": [
            [
                "d95f7c5c.6ce9f"
            ]
        ]
    },
    {
        "id": "e20620cf.17cf1",
        "type": "inject",
        "z": "8caaa155.e5486",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "odd3",
        "payloadType": "global",
        "x": 150,
        "y": 1080,
        "wires": [
            [
                "157a03ab.0e6b3c"
            ]
        ]
    },
    {
        "id": "d95f7c5c.6ce9f",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "odd",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 1080,
        "wires": [
            [
                "638ea2b2.4c38cc"
            ]
        ]
    },
    {
        "id": "638ea2b2.4c38cc",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 1080,
        "wires": []
    },
    {
        "id": "113adc2f.07d964",
        "type": "serial out",
        "z": "8caaa155.e5486",
        "name": "",
        "serial": "665ac286.d04e5c",
        "x": 2870,
        "y": 560,
        "wires": []
    },
    {
        "id": "ed0d4133.31948",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "シリアル作成",
        "func": "\n    \n    hexi[1]=msg.payload.em;\n    hexi[0]=msg.payload.car;\nHEX[1]=(hexi[0]<<4) +hexi[1];    \n    \n    value=msg.payload.zenku;\n    hexi[3]= (value % 10); value /= 10;\n    hexi[2]= (value % 10); value /= 10;\nHEX[2]=(hexi[2]<<4)+hexi[3];      \n    \n    value=msg.payload.genku;\n    hexi[5]= (value % 10); value /= 10;\n    hexi[4]= (value % 10); value /= 10;\nHEX[3]=(hexi[4]<<4)+hexi[5];      \n      \n    value=msg.payload.kukyori;\n    hexi[11]= (value % 10); value /= 10;\n    hexi[10]= (value % 10); value /= 10;\n    hexi[9]= (value % 10); value /= 10;\n    hexi[8]= (value % 10); value /= 10;\n    hexi[7]= (value % 10); value /= 10;\n    hexi[6]= (value % 10); value /= 10;\nHEX[4]=(hexi[6]<<4) +hexi[7];\nHEX[5]=(hexi[8]<<4) +hexi[9];\nHEX[6]=(hexi[10]<<4) +hexi[11];\n\n    value=msg.payload.kyori;\n    hexi[17]= (value % 10); value /= 10;\n    hexi[16]= (value % 10); value /= 10;\n    hexi[15]= (value % 10); value /= 10;\n    hexi[14]= (value % 10); value /= 10;\n    hexi[13]= (value % 10); value /= 10;\n    hexi[12]= (value % 10); value /= 10;\nHEX[7]=(hexi[12]<<4) +hexi[13];\nHEX[8]=(hexi[14]<<4) +hexi[15];\nHEX[9]=(hexi[16]<<4) +hexi[17];\n    chk=0;\n    for(k=1; k<=9;k++){\n        chk=chk+HEX[k];\n    }   \n    chk=chk&255;\n    ck1=chk>>4;\n    ck2=chk&15;\nHEX[10]=ck1;\nHEX[11]=ck2;         \n      \nmsg.payload=HEX;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nHEX =new Buffer(13);\nhexi =new Buffer(18);\nHEX[0]=0xaa;\nHEX[12]=0xbb;\n",
        "finalize": "",
        "x": 2660,
        "y": 560,
        "wires": [
            [
                "113adc2f.07d964"
            ]
        ]
    },
    {
        "id": "a5aadeb3.94d03",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "GETシリアルデータ",
        "func": "msg.payload={\n    car:global.get(\"car\"),\n    em:global.get(\"em\"),\n    zenku:global.get(\"zenku\"),\n    genku:flow.get(\"genkus\"),\n    kukyori:flow.get(\"kukyoris\"),\n    //kyori:global.get(\"odd3\"),\n    kyori:msg.payload.dis,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 2600,
        "y": 620,
        "wires": [
            [
                "ed0d4133.31948"
            ]
        ]
    },
    {
        "id": "b8a1f3e0.53ee4",
        "type": "delay",
        "z": "8caaa155.e5486",
        "name": "",
        "pauseType": "delayv",
        "timeout": "3000",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 2380,
        "y": 620,
        "wires": [
            [
                "a5aadeb3.94d03"
            ]
        ]
    },
    {
        "id": "4a91634.3fc279c",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "delay",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1720,
        "y": 420,
        "wires": [
            [
                "26100445.94575c"
            ]
        ]
    },
    {
        "id": "56afe051.ca11f",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "手動リセット",
        "func": "var i=msg.payload.reset;\nx=global.get(\"ku\");\n//flow.set(\"odd\",0);\n\nmsg.payload={\n    meter:msg.payload.meter,\n    name:\"手動リセット\",\n    reset:i,\n    kukyori:x[i],\n    zenku:global.get(\"zenku\"),\n    kmh:0,\n    number:i,\n    dirdir:0,\n    kyori:0,\n\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 560,
        "wires": [
            [
                "efa8ccd1.168ca",
                "9c27eefa.fa52e"
            ]
        ]
    },
    {
        "id": "1b2e12f.1bf64ed",
        "type": "ui_form",
        "z": "8caaa155.e5486",
        "name": "",
        "label": "走距離修正",
        "group": "693bf46.1e1860c",
        "order": 21,
        "width": 5,
        "height": 1,
        "options": [
            {
                "label": "区",
                "value": "reset",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "距離",
                "value": "meter",
                "type": "number",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "reset": "",
            "meter": ""
        },
        "payload": "",
        "submit": "submit",
        "cancel": "cancel",
        "topic": "",
        "x": 1230,
        "y": 560,
        "wires": [
            [
                "56afe051.ca11f"
            ]
        ]
    },
    {
        "id": "c84d6900.3af8a8",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "総距離",
        "func": "i=flow.get(\"reset\")\ndate = new Date();\ntotal=global.get(\"total\");\nodd=flow.get(\"odd\");\n\nmsg.payload={\n    oddt:Math.floor(total[i]+odd),\n    odd:Math.floor(odd*10)/10,\n    remain:flow.get(\"remain\"),\n    kukyori:msg.payload.kukyori,\n    genku:flow.get(\"genku\"),\n    kmh:msg.payload.kmh,\n    time:Date.now(date),\n    //total:x[i-1],\n};\nreturn msg;\n\n//if(i==null){\n//    i=13;\n//    flow.set(\"genku\",13);\n//}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nflow.set(\"oddt\",0);\n//total=global.get(\"total\");\n//flow.set(\"genku\",1);\n//flow.set(\"oddt\",0);",
        "finalize": "",
        "libs": [],
        "x": 2610,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "c6852683.9a6ea8",
        "type": "ui_text",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "総距離",
        "format": "{{msg.payload.oddt}}",
        "layout": "row-spread",
        "x": 2790,
        "y": 220,
        "wires": []
    },
    {
        "id": "a1354360.58e1d",
        "type": "mqtt out",
        "z": "8caaa155.e5486",
        "name": "",
        "topic": "trip3/odd",
        "qos": "0",
        "retain": "true",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "4646bf9b.55c01",
        "x": 2700,
        "y": 400,
        "wires": []
    },
    {
        "id": "e888c71e.889998",
        "type": "json",
        "z": "8caaa155.e5486",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2490,
        "y": 400,
        "wires": [
            [
                "a1354360.58e1d",
                "5e3caa41.2acf84"
            ]
        ]
    },
    {
        "id": "1565f0cc.bd222f",
        "type": "ui_text",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "order": 7,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "GPS発行時間",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 920,
        "y": 140,
        "wires": []
    },
    {
        "id": "47c6db96.0685b4",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "imuスイッチ",
        "property": "imu",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 110,
        "y": 280,
        "wires": [
            [
                "166fbc8a.830d63"
            ],
            [
                "37f035d2.199f9a"
            ]
        ]
    },
    {
        "id": "166fbc8a.830d63",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "imu-gate",
        "property": "imu_gate",
        "propertyType": "global",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 300,
        "y": 280,
        "wires": [
            [
                "37f035d2.199f9a"
            ]
        ]
    },
    {
        "id": "ad3c93f9.7e7bd",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "3移動",
        "rules": [
            {
                "t": "set",
                "p": "payload.name",
                "pt": "msg",
                "to": "3移動",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.icon",
                "pt": "msg",
                "to": "arrow",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload.iconColor",
                "pt": "msg",
                "to": "green",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 510,
        "y": 420,
        "wires": [
            [
                "d8bd23a1.c0f91",
                "2abf06e4.628d2a",
                "7ec49f99.ef2c8",
                "8705f39c.f2825",
                "ed7da24b.b18b8",
                "251d272f.2b9198"
            ]
        ]
    },
    {
        "id": "2eccb42.bdba04c",
        "type": "ui_template",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "name": "誤差",
        "order": 16,
        "width": 3,
        "height": 5,
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2190,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "5880a6c.6864f58",
        "type": "json",
        "z": "8caaa155.e5486",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 90,
        "y": 200,
        "wires": [
            [
                "e9c0dd43.4262b",
                "318972a5.7387be"
            ]
        ]
    },
    {
        "id": "abdb5dda.7714f",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "tst変換",
        "func": "var date = new Date();\ndate.setTime(msg.payload*1000);\nmsg.payload = date.toString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 90,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "4c34114a.0e342",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "前後GPS",
        "func": "msg.payload={\n    lat:msg.payload.lat,\n    lon:msg.payload.lon,\n    latx:latx,\n    lony:lony,\n    tstd:tstd,\n    altd:altd,\n    //name:msg.payload.name,\n    alt:msg.payload.alt,\n    tst:msg.payload.tst,\n    acc:msg.payload.acc\n}\nlatx=msg.payload.lat;\nlony=msg.payload.lon;\ntstd=msg.payload.tst;\naltd=msg.payload.alt;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nlatx=0;\nlony=0;\ntstd=0;\naltd=0;",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 360,
        "wires": [
            [
                "ad03ac96.2c241"
            ]
        ]
    },
    {
        "id": "ad03ac96.2c241",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "latx not 0",
        "property": "payload.latx",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 100,
        "y": 420,
        "wires": [
            [
                "a6af5551.85af28"
            ]
        ]
    },
    {
        "id": "e5554408.dfbd78",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "速度方向勾配距離",
        "func": "min=flow.get(\"min\");\nif(flow.get(\"latx\") == null){\n    flow.set(\"latx\",msg.payload.latx);\n    flow.set(\"lony\",msg.payload.lony);\n}\n\nfunction distance(lat1, lng1, lat2, lng2 ) {\n    \n         lat1 *= Math.PI / 180;\n         lng1 *= Math.PI / 180;\n         lat2 *= Math.PI / 180;\n         lng2 *= Math.PI / 180;\n         dis = 1000*6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2))\n         return (Math.round(dis * 100)) / 100;\n    \n     \n}\n\nfunction direction(y1, x1, y2, x2) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI / 180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n   \n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\nreturn (Math.floor(dir*100)) / 100;\n}\n\nfunction redirection(y1, x1, y2, x2, bearing) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI /180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\n    re_dir=dir-bearing;\n    if(re_dir<0){\n        re_dir=re_dir+360;\n    }\nreturn (Math.floor(re_dir*100)) / 100;\n}\n\nfunction slope(alt1,alt2){\n    if((alt1-alt2) != 0){\n        climb=(alt1-alt2)*100/dis;\n    }\n    else{\n        climb=0;\n    }\n    return climb;\n}\n\nduration=(msg.payload.tst-msg.payload.tstd)/1000;//ミリ秒\ndist=distance(msg.payload.lat,msg.payload.lon,msg.payload.latx, msg.payload.lony);\n//speed=Math.round((dist/duration)*100)/100;\nspeed=dist/duration;\ndis=distance(msg.payload.lat,msg.payload.lon,flow.get(\"latx\"),flow.get(\"lony\"));\nkmh=speed*3.6;\n\nmsg.payload={\n    speed: speed,\n    dis:dis,\n    bearing: direction(msg.payload.latx, msg.payload.lony,msg.payload.lat,msg.payload.lon),\n    lat: msg.payload.lat,\n    lon: msg.payload.lon,\n    //latx:flow.get(\"latx\"),\n    //lony:flow.get(\"lony\"),\n    tst: msg.payload.tst,\n    tstd: msg.payload.tstd,\n    alt: msg.payload.alt,\n    //name:msg.payload.name,\n    kmh: kmh,\n    climb:slope(msg.payload.alt,msg.payload.altd),\n    acc:msg.payload.acc,\n    };\n    \nreturn msg;\n\n//}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\ndis=0.00",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "e9c0dd43.4262b",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "location",
        "property": "payload._type",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "location",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 300,
        "y": 200,
        "wires": [
            [
                "3ebc81fe.89a16e"
            ]
        ]
    },
    {
        "id": "318972a5.7387be",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 390,
        "y": 140,
        "wires": []
    },
    {
        "id": "5be61e6f.1fa6b",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "NEXTリセット",
        "func": "x=global.get(\"reset\");\ni=flow.get(\"reset\");\n\nmsg.payload={\n    meter:x[i+1].meter,\n    name:\"手動　\"+x[i+1].name,\n    reset:i+1,\n    kukyori:x[i+1].kukyori,\n    zenku:global.get(\"zenku\"),\n    kmh:0,\n    number:x[i+1].number,\n    kyori:0,\n    dirdir:0,\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 500,
        "wires": [
            [
                "efa8ccd1.168ca",
                "9c27eefa.fa52e"
            ]
        ]
    },
    {
        "id": "bd306c8.116a19",
        "type": "template",
        "z": "8caaa155.e5486",
        "name": "現情報",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{payload.genku}}/{{payload.zenku}}区　3移動距離:{{payload.odd}}m/{{payload.kukyori}}m",
        "output": "str",
        "x": 2250,
        "y": 480,
        "wires": [
            [
                "973a02b6.f59d",
                "c21639fd.18cc48"
            ]
        ]
    },
    {
        "id": "37f035d2.199f9a",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "lat not null",
        "property": "payload.lat",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 110,
        "y": 360,
        "wires": [
            [
                "4c34114a.0e342"
            ]
        ]
    },
    {
        "id": "235ebb81.276a44",
        "type": "msg-size",
        "z": "8caaa155.e5486",
        "name": "",
        "frequency": "min",
        "interval": 1,
        "statusContent": "tot",
        "estimation": false,
        "ignore": false,
        "pauseAtStartup": false,
        "humanReadableStatus": true,
        "x": 100,
        "y": 100,
        "wires": [
            [],
            [
                "5880a6c.6864f58"
            ]
        ]
    },
    {
        "id": "7b66ebab.dd0db4",
        "type": "split",
        "z": "8caaa155.e5486",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1850,
        "y": 580,
        "wires": [
            [
                "37a9e060.16747"
            ]
        ]
    },
    {
        "id": "37a9e060.16747",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "g.lat3→latx",
        "rules": [
            {
                "t": "set",
                "p": "payload.latx",
                "pt": "msg",
                "to": "lat3",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.lony",
                "pt": "msg",
                "to": "lon3",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.bearing",
                "pt": "msg",
                "to": "bearing3",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 580,
        "wires": [
            [
                "2794ad37.bc62f2"
            ]
        ]
    },
    {
        "id": "f53f4373.eb9e9",
        "type": "file",
        "z": "8caaa155.e5486",
        "name": "",
        "filename": "/home/pi/samba/public/log3.csv",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 2430,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "6b03dd53.bf3a34",
        "type": "csv",
        "z": "8caaa155.e5486",
        "name": "",
        "sep": ",",
        "hdrin": "",
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 2190,
        "y": 740,
        "wires": [
            [
                "f53f4373.eb9e9"
            ]
        ]
    },
    {
        "id": "973a02b6.f59d",
        "type": "ui_template",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "name": "距離情報",
        "order": 4,
        "width": 0,
        "height": 0,
        "format": "<font size=\"5\"><div ng-bind-html=\"msg.payload\"></div></font>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2440,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "75ac908c.5d04",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "delay測定",
        "func": "date = new Date();\ndelay=date-msg.payload.tst*1000;\nglobal.set(\"delay3\",delay);\nmsg.payload=global.get(\"delay1\")-delay;\n//msg.payload=Date.now(date);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 440,
        "y": 60,
        "wires": [
            [
                "d30bd863.676a38"
            ]
        ]
    },
    {
        "id": "d30bd863.676a38",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 60,
        "wires": []
    },
    {
        "id": "b3ffa02a.fd77a",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "odd3t",
        "rules": [
            {
                "t": "set",
                "p": "odd3t",
                "pt": "global",
                "to": "payload.oddt",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2250,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "5e3caa41.2acf84",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2710,
        "y": 360,
        "wires": []
    },
    {
        "id": "c8121a60.15c898",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2280,
        "y": 320,
        "wires": []
    },
    {
        "id": "49349dbe.eb9864",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "resetエリア限定",
        "func": "reset=global.get(\"reset\");\ngenku=msg.payload.genku;\nif(genku >= msg.payload.zenku){\n    genku=1;\n}\nmsg.payload=[reset[0],reset[genku],reset[genku+1]];\n//msg.payload=reset[genku][genku+1];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1940,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "ad03a42.31b8e58",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "",
        "property": "car",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "3",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2220,
        "y": 620,
        "wires": [
            [
                "b8a1f3e0.53ee4"
            ]
        ]
    },
    {
        "id": "c21639fd.18cc48",
        "type": "ui_template",
        "z": "8caaa155.e5486",
        "group": "4707e75.554a618",
        "name": "3移動情報",
        "order": 4,
        "width": 0,
        "height": 0,
        "format": "<font size=\"4\"><div ng-bind-html=\"msg.payload\"></div></font>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2450,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "2abf06e4.628d2a",
        "type": "link out",
        "z": "8caaa155.e5486",
        "name": "",
        "links": [
            "c8cf950a.49f148",
            "dfa3b187.7efc"
        ],
        "x": 695,
        "y": 340,
        "wires": []
    },
    {
        "id": "8eedf7f1.a8fd28",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2550,
        "y": 1580,
        "wires": []
    },
    {
        "id": "e51aea7.d3c3d18",
        "type": "template",
        "z": "f20b3fe7.75306",
        "name": "リセット情報",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<b>リセット{{payload.reset}}　　{{payload.name}}</b>",
        "output": "str",
        "x": 2560,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "c4b1dd3e.f3235",
        "type": "ui_template",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "name": "リセット情報",
        "order": 7,
        "width": 0,
        "height": 0,
        "format": "<font size=\"4\"><div ng-bind-html=\"msg.payload\"></div></font>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2400,
        "y": 1060,
        "wires": [
            []
        ]
    },
    {
        "id": "ac54f394.7a2df",
        "type": "ui_text",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "order": 6,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "総距離",
        "format": "{{msg.payload.oddt}}",
        "layout": "row-spread",
        "x": 2190,
        "y": 720,
        "wires": []
    },
    {
        "id": "47974e05.56b0c",
        "type": "debug",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1410,
        "y": 200,
        "wires": []
    },
    {
        "id": "c2ebd39.4cee4b",
        "type": "inject",
        "z": "f20b3fe7.75306",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "reset.3",
        "payloadType": "global",
        "x": 2110,
        "y": 1540,
        "wires": [
            [
                "24981a3f.c9fbb6"
            ]
        ]
    },
    {
        "id": "84b8dd27.abd21",
        "type": "change",
        "z": "536d4aff.8b6084",
        "name": "係数ｘ距離",
        "rules": [
            {
                "t": "set",
                "p": "payload.dis",
                "pt": "msg",
                "to": "$flowContext(\"$parent.coe\")*msg.payload.dis",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 870,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "6599347c.610e5c",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1970,
        "y": 700,
        "wires": []
    },
    {
        "id": "4560ed4d.5b7034",
        "type": "template",
        "z": "f20b3fe7.75306",
        "name": "現情報",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<font size=\"5\">{{payload.genku}}/{{payload.zenku}}区　1移動距離:{{payload.kyori}}m/{{payload.kukyori}}m </font>",
        "output": "str",
        "x": 2810,
        "y": 740,
        "wires": [
            [
                "89d57ec3.c2a2a"
            ]
        ]
    },
    {
        "id": "89d57ec3.c2a2a",
        "type": "ui_template",
        "z": "f20b3fe7.75306",
        "group": "b90ab216.c29668",
        "name": "遅延現情報",
        "order": 5,
        "width": 0,
        "height": 0,
        "format": "<font size=\"4\"><div ng-bind-html=\"msg.payload\"></div></font>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2990,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "c35aec7a.44ebb",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "global.resetセット",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "reset",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1950,
        "y": 820,
        "wires": [
            [
                "ebdebaa0.b9af28"
            ]
        ]
    },
    {
        "id": "7dda2e42.b7a2f",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "payload.dis",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1690,
        "y": 700,
        "wires": [
            [
                "c848b4a6.5a3658"
            ]
        ]
    },
    {
        "id": "c2d88f2e.41a4f",
        "type": "function",
        "z": "361ce87e.80f648",
        "name": "@距離算出",
        "func": "function distance(lat1, lng1, lat2, lng2) {\n  lat1 *= Math.PI / 180;\n  lng1 *= Math.PI / 180;\n  lat2 *= Math.PI / 180;\n  lng2 *= Math.PI / 180;\n  dis = 6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2));\nreturn (Math.round(dis * 1000)) / 1000\n}\n\n\n\nmsg.payload={\n    lat:msg.payload.lat,\n    lon:msg.payload.lon,\n    latx:msg.payload.latx,\n    lony:msg.payload.lony,\n    kyori: distance(msg.payload.lat,msg.payload.lon,msg.payload.latx, msg.payload.lony),\n    //dir: dirc,\n    name: msg.payload.name,\n    //re_dir: redirection(msg.payload.latx, msg.payload.lony,msg.payload.lat,msg.payload.lon,msg.payload.bearing),\n    number:msg.payload.number,\n    reset:msg.payload.reset,\n    meter:msg.payload.meter,\n    bearing: msg.payload.bearing,\n    kukyori:msg.payload.kukyori,\n    //zenku:msg.payload.zenku,\n    approach:msg.payload.approach\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 250,
        "y": 80,
        "wires": [
            [
                "e90e9981.92edf8"
            ]
        ]
    },
    {
        "id": "e90e9981.92edf8",
        "type": "switch",
        "z": "361ce87e.80f648",
        "name": "リセットエリア",
        "property": "payload.kyori",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "$flowContext(\"$parent.radius\")/1000 ",
                "vt": "jsonata"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 440,
        "y": 80,
        "wires": [
            [
                "8dbecf4d.43d99"
            ]
        ]
    },
    {
        "id": "8dbecf4d.43d99",
        "type": "function",
        "z": "361ce87e.80f648",
        "name": "@角度",
        "func": "function distance(lat1, lng1, lat2, lng2) {\n  lat1 *= Math.PI / 180;\n  lng1 *= Math.PI / 180;\n  lat2 *= Math.PI / 180;\n  lng2 *= Math.PI / 180;\n  dis = 6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2));\nreturn (Math.round(dis * 1000)) / 1000\n}\n\nfunction direction(y1, x1, y2, x2) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI / 180;\n    x2 *= Math.PI / 180;\n    //x1 = Math.toRadians(x1);\n   // x2 = Math.toRadians(x2);\n   // y1 = Math.toRadians(y1);\n   // y2 = Math.toRadians(y2);\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n    //deg = Math.toDegrees(Math.atan2(a,b-c));\n    //angle = (deg + 360) % 360;\n    //return  (Math.abs(angle) + (1 / 7200));\n//return  90-Math.atan2( Math.sin(x2-x1), Math.cos(y1)*Math.tan(y2)-Math.sin(y1)*Math.cos(x2-x1));\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n//return  Math.atan2(a,b-c)*180/Math.PI;\n    if(dir<0){\n        dir=dir+360;\n    }\nreturn (Math.floor(dir*100)) / 100;\n}\n\nfunction redirection(y1, x1, y2, x2, bearing) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI /180;\n    x2 *= Math.PI / 180;\n    //x1 = Math.toRadians(x1);\n   // x2 = Math.toRadians(x2);\n   // y1 = Math.toRadians(y1);\n   // y2 = Math.toRadians(y2);\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n    //deg = Math.toDegrees(Math.atan2(a,b-c));\n    //angle = (deg + 360) % 360;\n    //return  (Math.abs(angle) + (1 / 7200));\n//return  90-Math.atan2( Math.sin(x2-x1), Math.cos(y1)*Math.tan(y2)-Math.sin(y1)*Math.cos(x2-x1));\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n//return  Math.atan2(a,b-c)*180/Math.PI;\n    if(dir<0){\n        dir=dir+360;\n    }\n    re_dir=dir-bearing;\n    if(re_dir<0){\n        re_dir=re_dir+360;\n    }\nreturn (Math.floor(re_dir*100)) / 100;\n}\n\n//function kmh(x) {\n//return (Math.round(x*3.6*100))/100;\n//}\ndirc=direction(msg.payload.lat, msg.payload.lon,msg.payload.latx,msg.payload.lony),\n\n\nmsg.payload={\n    //lat:msg.payload.lat,\n    //lon:msg.payload.lon,\n    //latx:msg.payload.latx,\n   // lony:msg.payload.lony,\n    kyori: msg.payload.kyori,\n    dir: dirc,\n    name: msg.payload.name,\n    //re_dir: redirection(msg.payload.latx, msg.payload.lony,msg.payload.lat,msg.payload.lon,msg.payload.bearing),\n    number:msg.payload.number,\n    reset:msg.payload.reset,\n    meter:msg.payload.meter,\n    bearing: msg.payload.bearing,\n    kukyori:msg.payload.kukyori,\n    //zenku:msg.payload.zenku,\n    approach:msg.payload.approach\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 390,
        "y": 140,
        "wires": [
            [
                "2b5022a0.953c2e"
            ]
        ]
    },
    {
        "id": "2b5022a0.953c2e",
        "type": "function",
        "z": "361ce87e.80f648",
        "name": "角度差",
        "func": "function dir180(dir1,dir2) {\n    dir12=dir1-dir2;\n    if(dir12>180){\n    dir12=dir12-360;\n    }\nif(dir12<-180){\n        dir12=dir12+360;\n    }\n    return dir12;\n}\n//dirdir=msg.payload.dir-msg.payload.bearing;\n//if(dirdir>180){\n//    dirdir=dirdir-360;\n//    }\n//if(dirdir<-180){\n//        dirdir=dirdir+360;\n//    }\n    \nmsg.payload={\n    //dirdir:dirdir,\n    dirdir:dir180(msg.payload.dir,msg.payload.bearing),\n    approach:dir180(msg.payload.approach,msg.payload.bearing),\n    kyori:msg.payload.kyori,\n    name:msg.payload.name,\n    meter:msg.payload.meter,\n    reset:msg.payload.reset,\n    kukyori:msg.payload.kukyori,\n    number:msg.payload.number,\n    //lat:msg.payload.lat,\n    //lon:msg.payload.lon,\n    //zenku:msg.payload.zenku\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 140,
        "wires": [
            [
                "6fb5b41.24d074c"
            ]
        ]
    },
    {
        "id": "6fb5b41.24d074c",
        "type": "switch",
        "z": "361ce87e.80f648",
        "name": "進入角",
        "property": "payload.approach",
        "propertyType": "msg",
        "rules": [
            {
                "t": "btwn",
                "v": "-30",
                "vt": "num",
                "v2": "30",
                "v2t": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 390,
        "y": 200,
        "wires": [
            [
                "83d9255d.60bb78"
            ]
        ]
    },
    {
        "id": "83d9255d.60bb78",
        "type": "switch",
        "z": "361ce87e.80f648",
        "name": "リセット通過",
        "property": "payload.dirdir",
        "propertyType": "msg",
        "rules": [
            {
                "t": "btwn",
                "v": "-90",
                "vt": "num",
                "v2": "90",
                "v2t": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 540,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "b582e164.1a557",
        "type": "function",
        "z": "7e6f2d4d.3bcd74",
        "name": "リセット",
        "func": "\nfunction TIME(time){\ndate = new Date(time);\nvar hh = (\"0\"+date.getHours()).slice(-2);\nvar mm = (\"0\"+date.getMinutes()).slice(-2);\nvar ss = (\"0\"+date.getSeconds()).slice(-2);\nvar mmm =(\"00\"+date.getMilliseconds()).slice(-3);\n\nreturn hh+\":\"+mm+\":\"+ss+\":\"+mmm;\n}\n\nfunction degToRad(degrees) {\n  return degrees * (Math.PI / 180);\n}\n\ndirdir=90-Math.abs(msg.payload.dirdir)\nrad=degToRad(dirdir);\ny=Math.sin(rad)*msg.payload.kyori*1000;//前後座標間距離\ny=Math.round(y*10)/10;\n//x=Math.round((flow.get(\"odd\")*10))/10;\nodd=flow.get(\"$parent.odd\");\ntotal=global.get(\"total\");\ncoe=global.get(\"coe\");\nj++;\nvar i=msg.payload.reset-1;\n\nif(flow.get(\"$parent.reset\") != i+1){//リセット区間が違うなら\n//if(flow.get(\"odd\") >100){\n    flow.set(\"$parent.coe\",coe[i+1]);\n    flow.set(\"$parent.odd\",msg.payload.meter+y);\n    tst[i]=msg.payload.time;\n    time[i]=TIME(msg.payload.time);\n    \n    trip[i]=Math.round((odd-y)*100)/100;\n    if(msg.payload.meter==0){\n        error[i]=Math.round((trip[i]-kukyori)*100)/100;\n    }else{\n        error[i]=error[i]=Math.round((trip[i]-msg.payload.meter)*100)/100;\n    }\n    lap[i]=(TIME(tst[i]-tst[i-1]-9*60*60*1000)).slice(-9);\n    over[i]=y;\n}\n\ntrip[0]=j;\nflow.set(\"$parent.genku\",msg.payload.number);\nflow.set(\"$parent.reset\",msg.payload.reset);\nkukyori=msg.payload.kukyori;\nflow.set(\"$parent.kukyori\",kukyori);\n\nmsg.payload={\n    //dis:flow.get(\"odd\"),\n    //dis:msg.payload.meter,\n    name:msg.payload.name,\n    number:msg.payload.number,\n    kukyori:msg.payload.kukyori,\n    zenku:global.get(\"zenku\"),\n    trip:trip,\n    time:time,\n    lap:lap,\n    itrip:trip[i],\n    itime:TIME(msg.payload.time),\n    ilap:lap[i],\n    ku:i,\n    error:error,\n    lat:lat,\n    lon:lon,\n    dirdir:msg.payload.dirdir,\n    reset:msg.payload.reset,\n    //odd:msg.payload.meter+y,\n    odd:odd,\n    over:over,\n}\n\nflow.set(\"$parent.trip\",trip);\nflow.set(\"$parent.error\",error);\nflow.set(\"$parent.time\",time);\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nflow.set(\"$parent.trip\" ,Array());\ntrip =Array();\nflow.set(\"$parent.error\",Array());\nerror=Array();\nover=Array();\ntime=Array();\ntst=Array();\nlap=Array();\nlat=Array();\nlon=Array();\nj=0;\nkukyori=0;",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 220,
        "wires": [
            [
                "b0eb4e94.9591",
                "e1bd0147.bb87b",
                "ce28cb3f.2f3028",
                "850c17e.8f259e8",
                "f298cc9e.a2cc"
            ]
        ]
    },
    {
        "id": "850c17e.8f259e8",
        "type": "change",
        "z": "7e6f2d4d.3bcd74",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload.zenku",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.trip",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.time",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.lap",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.ku",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.error",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.lat",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.lon",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "payload.dis",
                "pt": "msg",
                "to": "odd",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 60,
        "wires": [
            [
                "4f8a6ac0.efe414"
            ]
        ]
    },
    {
        "id": "f298cc9e.a2cc",
        "type": "template",
        "z": "7e6f2d4d.3bcd74",
        "name": "リセット情報",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<b>リセット{{payload.reset}}　　{{payload.name}}</b>",
        "output": "str",
        "x": 680,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "b0eb4e94.9591",
        "type": "template",
        "z": "7e6f2d4d.3bcd74",
        "name": "通過距離・時刻",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "リセット回数　{{payload.trip.0}} {{payload.time.0}}<br>\n１区　{{payload.trip.1}}m　{{payload.error.1}}　{{payload.time.1}}　{{payload.lap.1}}<br>\n２区　{{payload.trip.2}}m　{{payload.error.2}}　{{payload.time.2}}　{{payload.lap.2}}<br>\n３区　{{payload.trip.3}}m　{{payload.error.3}}　{{payload.time.3}}　{{payload.lap.3}}<br>\n４区　{{payload.trip.4}}m　{{payload.error.4}}　{{payload.time.4}}　{{payload.lap.4}}<br>\n５区　{{payload.trip.5}}m　{{payload.error.5}}　{{payload.time.5}}　{{payload.lap.5}}<br>\n６区　{{payload.trip.6}}m　{{payload.error.6}}　{{payload.time.6}}　{{payload.lap.6}}<br>\n７区　{{payload.trip.7}}m　{{payload.error.7}}　{{payload.time.7}}　{{payload.lap.7}}<br>\n８区　{{payload.trip.8}}m　{{payload.error.8}}　{{payload.time.8}}　{{payload.lap.8}}<br>\n９区　{{payload.trip.9}}m　{{payload.error.9}}　{{payload.time.9}}　{{payload.lap.9}}<br>\n10区　{{payload.trip.10}}m　{{payload.error.10}}　{{payload.time.10}}　{{payload.lap.10}}<br>\n11区　{{payload.trip.11}}m　{{payload.error.11}}　{{payload.time.11}}　{{payload.lap.11}}<br>\n12区　{{payload.trip.12}}m　{{payload.error.12}}　{{payload.time.12}}　{{payload.lap.12}}",
        "output": "str",
        "x": 680,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "e1bd0147.bb87b",
        "type": "change",
        "z": "7e6f2d4d.3bcd74",
        "name": "グローバル化",
        "rules": [
            {
                "t": "set",
                "p": "kukyori1",
                "pt": "global",
                "to": "payload.kukyori",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "genku1",
                "pt": "global",
                "to": "payload.number",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "odd1",
                "pt": "global",
                "to": "odd",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "ce28cb3f.2f3028",
        "type": "template",
        "z": "7e6f2d4d.3bcd74",
        "name": "距離誤差",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "0　{{payload.error.0}}　{{payload.over.0}}<br>\n1　{{payload.error.1}}  {{payload.over.1}}<br>\n2　{{payload.error.2}}  {{payload.over.2}}<br>\n3　{{payload.error.3}}　{{payload.over.3}}<br>\n4　{{payload.error.4}}　{{payload.over.4}}<br>\n5　{{payload.error.5}}　{{payload.over.5}}<br>\n6　{{payload.error.6}}　{{payload.over.6}}<br>\n7　{{payload.error.7}}　{{payload.over.7}}<br>\n8　{{payload.error.8}}　{{payload.over.8}}<br>\n9　{{payload.error.9}}　{{payload.over.9}}<br>\n10　{{payload.error.10}}　{{payload.over.10}}<br>\n11　{{payload.error.11}}　{{payload.over.11}}<br>\n12　{{payload.error.12}}　{{payload.over.12}}",
        "output": "str",
        "x": 660,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "4f8a6ac0.efe414",
        "type": "csv",
        "z": "7e6f2d4d.3bcd74",
        "name": "",
        "sep": ",",
        "hdrin": "",
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 870,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "a6aff84e.7382e8",
        "type": "change",
        "z": "7e6f2d4d.3bcd74",
        "name": "ディレイ/時間付加",
        "rules": [
            {
                "t": "set",
                "p": "payload.time",
                "pt": "msg",
                "to": "",
                "tot": "date"
            },
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "delay",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 220,
        "wires": [
            [
                "b582e164.1a557"
            ]
        ]
    },
    {
        "id": "5a3d574f.e4ff08",
        "type": "subflow:7e6f2d4d.3bcd74",
        "z": "f20b3fe7.75306",
        "name": "",
        "env": [],
        "x": 2120,
        "y": 1040,
        "wires": [
            [
                "d0ba0fa5.7e635"
            ],
            [
                "c4b1dd3e.f3235"
            ],
            [
                "b0c40c50.5b596"
            ],
            [
                "51f2474a.5074c8"
            ]
        ]
    },
    {
        "id": "51f2474a.5074c8",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2390,
        "y": 1140,
        "wires": []
    },
    {
        "id": "5c8988f.8809878",
        "type": "subflow:361ce87e.80f648",
        "z": "f20b3fe7.75306",
        "name": "",
        "env": [],
        "x": 2160,
        "y": 940,
        "wires": [
            [
                "ef924eff.0b554"
            ],
            [
                "5a3d574f.e4ff08",
                "48d34597.e03bbc"
            ]
        ]
    },
    {
        "id": "ccec0a3e.cb1d48",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "gps誤差グローバル化",
        "rules": [
            {
                "t": "set",
                "p": "epx1",
                "pt": "global",
                "to": "payload.epx",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "epy1",
                "pt": "global",
                "to": "payload.epy",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "d4073990.037ef8",
        "type": "subflow:536d4aff.8b6084",
        "z": "f20b3fe7.75306",
        "name": "",
        "env": [],
        "x": 680,
        "y": 760,
        "wires": [
            [
                "c848b4a6.5a3658"
            ]
        ]
    },
    {
        "id": "9d5ce64.d0dd718",
        "type": "change",
        "z": "f20b3fe7.75306",
        "name": "global1移動",
        "rules": [
            {
                "t": "set",
                "p": "lat1",
                "pt": "global",
                "to": "payload.lat",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "lon1",
                "pt": "global",
                "to": "payload.lon",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "name1",
                "pt": "global",
                "to": "payload.name",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "bearing1",
                "pt": "global",
                "to": "payload.bearing",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "iconColor1",
                "pt": "global",
                "to": "payload.iconColor",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "color1",
                "pt": "global",
                "to": "payload.color",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "a6af5551.85af28",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "速度方向勾配距離",
        "func": "\n\nfunction distance(lat1, lng1, lat2, lng2 ) {\n    \n         lat1 *= Math.PI / 180;\n         lng1 *= Math.PI / 180;\n         lat2 *= Math.PI / 180;\n         lng2 *= Math.PI / 180;\n         dis = 1000*6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2))\n         return (Math.round(dis * 100)) / 100;\n    \n     \n}\n\nfunction direction(y1, x1, y2, x2) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI / 180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n   \n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\nreturn (Math.floor(dir*100)) / 100;\n}\n\nfunction redirection(y1, x1, y2, x2, bearing) {\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI /180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\n    re_dir=dir-bearing;\n    if(re_dir<0){\n        re_dir=re_dir+360;\n    }\nreturn (Math.floor(re_dir*100)) / 100;\n}\n\nfunction slope(alt1,alt2){\n    if((alt1-alt2) != 0){\n        climb=(alt1-alt2)*100/dis;\n    }\n    else{\n        climb=0;\n    }\n    return climb;\n}\n\nduration=msg.payload.tst-msg.payload.tstd;\ndist=distance(msg.payload.lat,msg.payload.lon,msg.payload.latx, msg.payload.lony);\n//speed=Math.round((dist/duration)*100)/100;\nspeed=(dist/duration)*1000;//秒速(m/s)\ndis=distance(msg.payload.lat,msg.payload.lon,flow.get(\"latx\"),flow.get(\"lony\"));\nkmh=Math.round((speed*3.6*10)/10);//時速(km/h)\n\nmsg.payload.speed=speed;\nmsg.payload.bearing=direction(msg.payload.latx, msg.payload.lony,msg.payload.lat,msg.payload.lon);\nmsg.payload.kmh=kmh;    \nmsg.payload.dis=dist;\n    \nreturn msg;\n\n//}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\ndis=0.00",
        "finalize": "",
        "libs": [],
        "x": 310,
        "y": 420,
        "wires": [
            [
                "ad3c93f9.7e7bd"
            ]
        ]
    },
    {
        "id": "3ebc81fe.89a16e",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "time",
        "rules": [
            {
                "t": "set",
                "p": "payload.tst",
                "pt": "msg",
                "to": "payload.tst*1000",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 200,
        "wires": [
            [
                "47c6db96.0685b4",
                "89e816d8.a65338"
            ]
        ]
    },
    {
        "id": "89e816d8.a65338",
        "type": "moment",
        "z": "8caaa155.e5486",
        "name": "",
        "topic": "",
        "input": "payload.tst",
        "inputType": "msg",
        "inTz": "Asia/Tokyo",
        "adjAmount": "9",
        "adjType": "hours",
        "adjDir": "add",
        "format": "date",
        "locale": "ja-JP",
        "output": "",
        "outputType": "msg",
        "outTz": "Asia/Tokyo",
        "x": 680,
        "y": 140,
        "wires": [
            [
                "1565f0cc.bd222f"
            ]
        ]
    },
    {
        "id": "67abd3ba.cb8ebc",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "@時差距離re角度",
        "func": "function distance(lat1, lng1, lat2, lng2 ) {//２点間距離\n    \n         lat1 *= Math.PI / 180;\n         lng1 *= Math.PI / 180;\n         lat2 *= Math.PI / 180;\n         lng2 *= Math.PI / 180;\n         dis = 1000*6371 * Math.acos(Math.cos(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1) + Math.sin(lat1) * Math.sin(lat2))\n         return (Math.round(dis * 100)) / 100;\n    \n     \n}\n\nfunction direction(y1, x1, y2, x2) {//２点間角度\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI / 180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n   \n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\nreturn (Math.floor(dir*100)) / 100;\n}\n\nfunction redirection(y1, x1, y2, x2, bearing) {//進行方向との角度\n    z = x2-x1\n    z *=  Math.PI / 180;\n    y1 *= Math.PI / 180;\n    x1 *= Math.PI / 180;\n    y2 *= Math.PI /180;\n    x2 *= Math.PI / 180;\n\n    a=Math.sin(z);\n    b=Math.cos(y1)*Math.tan(y2);\n    c=Math.sin(y1)*Math.cos(z);\n\n    dir=Math.atan2(a,b-c)*180/Math.PI;\n\n    if(dir<0){\n        dir=dir+360;\n    }\n    re_dir=dir-bearing;\n    if(re_dir<0){\n        re_dir=re_dir+360;\n    }\nreturn (Math.floor(re_dir*100)) / 100;\n}\n\n\ngenku=flow.get(\"genku\");\nreset=flow.get(\"reset\");\ndist=distance(msg.payload.lat,msg.payload.lon,msg.payload.latx, msg.payload.lony);\n\n\nif(dist>=0){\nmsg.payload={\n    dis:dist,\n    track: msg.payload.track,\n    lat: msg.payload.lat,\n    lon: msg.payload.lon,\n    latx:msg.payload.latx,\n    lony:msg.payload.lony,\n    tst: msg.payload.tst,\n    tstd: msg.payload.tstd,\n    alt: msg.payload.alt,\n    altd: msg.payload.altd,\n    speed:msg.payload.speed,\n    kmh:msg.payload.speed*3.6,\n    //kmh: Math.round((msg.payload.speed*3.6*100))/100,\n    climb: msg.payload.climb,\n    acc:msg.payload.acc,\n    //device: msg.payload.device,\n    };\nreturn msg;\n}\n//}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\ndist=0.00",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "7ec49f99.ef2c8",
        "type": "subflow:536d4aff.8b6084",
        "z": "8caaa155.e5486",
        "name": "",
        "x": 860,
        "y": 420,
        "wires": [
            [
                "4a91634.3fc279c"
            ]
        ]
    },
    {
        "id": "efa8ccd1.168ca",
        "type": "subflow:7e6f2d4d.3bcd74",
        "z": "8caaa155.e5486",
        "name": "",
        "x": 1860,
        "y": 720,
        "wires": [
            [
                "6b03dd53.bf3a34"
            ],
            [
                "f715e3fa.0c6cf"
            ],
            [
                "2eccb42.bdba04c"
            ],
            [
                "e442358e.bbd4d8"
            ]
        ]
    },
    {
        "id": "e442358e.bbd4d8",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2210,
        "y": 880,
        "wires": []
    },
    {
        "id": "f715e3fa.0c6cf",
        "type": "ui_template",
        "z": "8caaa155.e5486",
        "group": "693bf46.1e1860c",
        "name": "リセット情報",
        "order": 9,
        "width": 0,
        "height": 0,
        "format": "<font size=\"4\"><div ng-bind-html=\"msg.payload\"></div></font>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2220,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "e13bda8.47bd328",
        "type": "function",
        "z": "f20b3fe7.75306",
        "name": "新距離積算",
        "func": "flow.set(\"odd\",flow.get(\"odd\")+msg.payload.dis);\n//flow.set(\"odds\",flow.get(\"odd\"));\n//kukyori=global.get(\"ku\");\nkukyori=flow.get(\"kukyori\");\ngenku=flow.get(\"genku\");\ni=flow.get(\"reset\")\ndate = new Date();\ntotal=global.get(\"total\");\nodd=(Math.floor(flow.get(\"odd\")*100)) / 100;\n\nmsg.payload={\n    genku:genku,\n    zenku:global.get(\"zenku\"),\n    odd:odd,\n    kukyori:kukyori,\n    kmh:msg.payload.kmh,\n    reset:i,\n    coe:flow.get(\"coe\"),\n    oddt:Math.floor(total[i]+odd),\n    remain:flow.get(\"remain\"),\n    time:Date.now(date),\n}\n    \n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nflow.set(\"odd\",0);\nflow.set(\"coe\",1);\nflow.set(\"reset\",0);\nflow.set(\"genku\",0);\nflow.set(\"kukyori\",0);\n//kukyori=global.get(\"ku\");",
        "finalize": "",
        "libs": [],
        "x": 1970,
        "y": 760,
        "wires": [
            [
                "11e9e1.b934961f",
                "7da66365.02947c",
                "c35aec7a.44ebb",
                "1d2a44dd.f7a67b",
                "d1086772.24d218",
                "6599347c.610e5c",
                "ac54f394.7a2df",
                "aef4c880.dd9898"
            ]
        ]
    },
    {
        "id": "2794ad37.bc62f2",
        "type": "subflow:361ce87e.80f648",
        "z": "8caaa155.e5486",
        "name": "",
        "x": 1900,
        "y": 640,
        "wires": [
            [
                "45af98ac.1f6048"
            ],
            [
                "efa8ccd1.168ca"
            ]
        ]
    },
    {
        "id": "45af98ac.1f6048",
        "type": "switch",
        "z": "8caaa155.e5486",
        "name": "jsonata flowContext",
        "property": "payload.reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "$flowContext(\"reset\") + 1",
                "vt": "jsonata"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 2230,
        "y": 680,
        "wires": [
            [
                "3428c820.48df78"
            ]
        ]
    },
    {
        "id": "3428c820.48df78",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "flow.remain",
        "rules": [
            {
                "t": "set",
                "p": "remain",
                "pt": "flow",
                "to": "$floor(payload.kyori*1000)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "remain",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2450,
        "y": 680,
        "wires": [
            [
                "70282c03.ee60c4"
            ]
        ]
    },
    {
        "id": "70282c03.ee60c4",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "GPS逆算距離",
        "func": "genku=flow.get(\"genku\");\nku=global.get(\"ku\");\nremain=msg.payload;\nmsg.payload={\n    oddr:ku[genku]-remain,\n    remain:remain,\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// ここに記述したコードは、ノードをデプロイした時に\n// 一度だけ実行されます。\nku=Array()",
        "finalize": "",
        "libs": [],
        "x": 2660,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "9c27eefa.fa52e",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.dis",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1720,
        "y": 500,
        "wires": [
            [
                "4a91634.3fc279c"
            ]
        ]
    },
    {
        "id": "ababc231.a3794",
        "type": "ui_text",
        "z": "9d68a1c7.f4976",
        "group": "693bf46.1e1860c",
        "order": 8,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "サーバー時間",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 740,
        "y": 900,
        "wires": []
    },
    {
        "id": "a726e4f3.d15a58",
        "type": "ui_text_input",
        "z": "8caaa155.e5486",
        "name": "",
        "label": "リセットポイント半径",
        "tooltip": "リセットポイント半径",
        "group": "693bf46.1e1860c",
        "order": 15,
        "width": 3,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": "0",
        "topic": "topic",
        "topicType": "msg",
        "x": 340,
        "y": 1340,
        "wires": [
            [
                "cb59caaa.f69928"
            ]
        ]
    },
    {
        "id": "cb59caaa.f69928",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "radius",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 1340,
        "wires": [
            []
        ]
    },
    {
        "id": "9fae4de8.02fd1",
        "type": "inject",
        "z": "8caaa155.e5486",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "15",
        "payloadType": "num",
        "x": 130,
        "y": 1340,
        "wires": [
            [
                "a726e4f3.d15a58"
            ]
        ]
    },
    {
        "id": "51859961.73b548",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "global.resetセット",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "reset",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1990,
        "y": 520,
        "wires": [
            [
                "7b66ebab.dd0db4"
            ]
        ]
    },
    {
        "id": "d5389993.d31f38",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "zenku&誤差付加",
        "rules": [
            {
                "t": "set",
                "p": "payload.zenku",
                "pt": "msg",
                "to": "zenku",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.epx",
                "pt": "msg",
                "to": "epx1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.epy",
                "pt": "msg",
                "to": "epy1",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2280,
        "y": 400,
        "wires": [
            [
                "e888c71e.889998"
            ]
        ]
    },
    {
        "id": "6515d444.3b847c",
        "type": "mqtt in",
        "z": "90be64ef.6b4fc8",
        "name": "",
        "topic": "request",
        "qos": "2",
        "datatype": "auto",
        "broker": "4646bf9b.55c01",
        "nl": false,
        "rap": true,
        "rh": 0,
        "x": 150,
        "y": 280,
        "wires": [
            [
                "596d7ca3.b682d4"
            ]
        ]
    },
    {
        "id": "dfa3b187.7efc",
        "type": "link in",
        "z": "9d68a1c7.f4976",
        "name": "",
        "links": [
            "2abf06e4.628d2a",
            "b74f199d.ee4458"
        ],
        "x": 95,
        "y": 580,
        "wires": [
            [
                "be042f3f.f2fad",
                "35707fe6.09419"
            ]
        ]
    },
    {
        "id": "9371e5be.f0d2f8",
        "type": "worldmap",
        "z": "9d68a1c7.f4976",
        "name": "",
        "lat": "",
        "lon": "",
        "zoom": "",
        "layer": "",
        "cluster": "",
        "maxage": "",
        "usermenu": "show",
        "layers": "show",
        "panit": "false",
        "panlock": "false",
        "zoomlock": "false",
        "hiderightclick": "false",
        "coords": "none",
        "showgrid": "false",
        "allowFileDrop": "false",
        "path": "/worldmap",
        "x": 780,
        "y": 620,
        "wires": []
    },
    {
        "id": "31a13cf8.95fad4",
        "type": "worldmap in",
        "z": "9d68a1c7.f4976",
        "name": "",
        "path": "/worldmap",
        "events": "all",
        "x": 220,
        "y": 680,
        "wires": [
            [
                "8c597f4f.e582",
                "20f3026.d6648fe",
                "a94a3dd0.7277f",
                "84a80025.1574e"
            ]
        ]
    },
    {
        "id": "8c597f4f.e582",
        "type": "change",
        "z": "9d68a1c7.f4976",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "base",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 660,
        "wires": [
            [
                "35707fe6.09419"
            ]
        ]
    },
    {
        "id": "20f3026.d6648fe",
        "type": "change",
        "z": "9d68a1c7.f4976",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "reset",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 700,
        "wires": [
            [
                "35707fe6.09419"
            ]
        ]
    },
    {
        "id": "ddc0d363.ef489",
        "type": "function",
        "z": "9d68a1c7.f4976",
        "name": "move map",
        "func": "msg.payload ={\n    command:{\n        lat: msg.payload.lat,\n        lon: msg.payload.lon,\n        //lat:global.get(\"lat3\"),\n        //lon:global.get(\"lon3\"),\n        //layer:\"Esri\",e\n    }    \n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 520,
        "wires": [
            [
                "35707fe6.09419"
            ]
        ]
    },
    {
        "id": "be042f3f.f2fad",
        "type": "switch",
        "z": "9d68a1c7.f4976",
        "name": "",
        "property": "payload.name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "select",
                "vt": "flow"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 250,
        "y": 520,
        "wires": [
            [
                "ddc0d363.ef489",
                "f080309b.ed16a"
            ]
        ]
    },
    {
        "id": "35707fe6.09419",
        "type": "ui_worldmap",
        "z": "9d68a1c7.f4976",
        "group": "4707e75.554a618",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "lat": "",
        "lon": "",
        "zoom": "",
        "layer": "",
        "cluster": "",
        "maxage": "",
        "usermenu": "hide",
        "layers": "show",
        "panit": "false",
        "panlock": "false",
        "zoomlock": "false",
        "hiderightclick": "false",
        "coords": "none",
        "showgrid": "true",
        "allowFileDrop": "false",
        "path": "/worldmap",
        "x": 640,
        "y": 580,
        "wires": []
    },
    {
        "id": "578b4fc.295a8b",
        "type": "ui_dropdown",
        "z": "9d68a1c7.f4976",
        "name": "",
        "label": "",
        "tooltip": "",
        "place": "Select option",
        "group": "4707e75.554a618",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "1移動",
                "value": "1移動",
                "type": "str"
            },
            {
                "label": "2移動",
                "value": "2移動",
                "type": "str"
            },
            {
                "label": "3移動",
                "value": "3移動",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "topic",
        "topicType": "msg",
        "x": 140,
        "y": 340,
        "wires": [
            [
                "cf122705.694d08"
            ]
        ]
    },
    {
        "id": "cf122705.694d08",
        "type": "change",
        "z": "9d68a1c7.f4976",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "select",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "f080309b.ed16a",
        "type": "debug",
        "z": "9d68a1c7.f4976",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 460,
        "wires": []
    },
    {
        "id": "a0157873.6c0a58",
        "type": "ui_template",
        "z": "f20b3fe7.75306",
        "group": "4707e75.554a618",
        "name": "距離情報",
        "order": 3,
        "width": 0,
        "height": 0,
        "format": "<font size=\"5\"><div ng-bind-html=\"msg.payload\"></div></font>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "x": 2360,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "aef4c880.dd9898",
        "type": "template",
        "z": "f20b3fe7.75306",
        "name": "現情報",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<font size=\"4\">{{payload.genku}}/{{payload.zenku}}区　1移動距離:{{payload.odd}}m/{{payload.kukyori}}m \n</font>",
        "output": "str",
        "x": 2190,
        "y": 580,
        "wires": [
            [
                "a0157873.6c0a58"
            ]
        ]
    },
    {
        "id": "1114b4ec.cafbdb",
        "type": "change",
        "z": "8caaa155.e5486",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "payload.dis",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1470,
        "y": 300,
        "wires": [
            [
                "4a91634.3fc279c"
            ]
        ]
    },
    {
        "id": "a7446ddf.b303",
        "type": "function",
        "z": "8caaa155.e5486",
        "name": "初期化",
        "func": "flow.set(\"odd\",0);\n//flow.set(\"odds\",0);\nmsg.payload={\n    dis:0.00,\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1430,
        "y": 360,
        "wires": [
            [
                "4a91634.3fc279c"
            ]
        ]
    },
    {
        "id": "4c0fe9df.152948",
        "type": "inject",
        "z": "9d68a1c7.f4976",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 770,
        "y": 340,
        "wires": [
            [
                "c1d0719a.ec6ff"
            ]
        ]
    },
    {
        "id": "368de350.c0943c",
        "type": "debug",
        "z": "9d68a1c7.f4976",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1210,
        "y": 340,
        "wires": []
    },
    {
        "id": "c1d0719a.ec6ff",
        "type": "moment",
        "z": "9d68a1c7.f4976",
        "name": "",
        "topic": "",
        "input": "",
        "inputType": "msg",
        "inTz": "",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "",
        "output": "",
        "outputType": "msg",
        "outTz": "",
        "x": 1010,
        "y": 340,
        "wires": [
            [
                "368de350.c0943c"
            ]
        ]
    },
    {
        "id": "67fd93ce.0458ac",
        "type": "debug",
        "z": "9d68a1c7.f4976",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 800,
        "wires": []
    },
    {
        "id": "a94a3dd0.7277f",
        "type": "switch",
        "z": "9d68a1c7.f4976",
        "name": "",
        "property": "payload.action",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "point",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 410,
        "y": 740,
        "wires": [
            [
                "3958886e.02f2b8"
            ]
        ]
    },
    {
        "id": "15e54224.13283e",
        "type": "csv",
        "z": "9d68a1c7.f4976",
        "name": "",
        "sep": ",",
        "hdrin": false,
        "hdrout": "none",
        "multi": "one",
        "ret": "\\n",
        "temp": "",
        "skip": "0",
        "strings": true,
        "include_empty_strings": "",
        "include_null_values": "",
        "x": 550,
        "y": 800,
        "wires": [
            [
                "ff69c836.c2ffd8"
            ]
        ]
    },
    {
        "id": "3958886e.02f2b8",
        "type": "change",
        "z": "9d68a1c7.f4976",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload.action",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.layer",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "payload.draggable",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 800,
        "wires": [
            [
                "15e54224.13283e"
            ]
        ]
    },
    {
        "id": "ff69c836.c2ffd8",
        "type": "file",
        "z": "9d68a1c7.f4976",
        "name": "",
        "filename": "point.csv",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 710,
        "y": 800,
        "wires": [
            [
                "67fd93ce.0458ac"
            ]
        ]
    },
    {
        "id": "236fd815.607ec8",
        "type": "file in",
        "z": "9d68a1c7.f4976",
        "name": "",
        "filename": "point.csv",
        "format": "lines",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 720,
        "y": 840,
        "wires": [
            [
                "67fd93ce.0458ac"
            ]
        ]
    },
    {
        "id": "5c15e2bf.7b807c",
        "type": "inject",
        "z": "9d68a1c7.f4976",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 540,
        "y": 840,
        "wires": [
            [
                "236fd815.607ec8"
            ]
        ]
    },
    {
        "id": "84a80025.1574e",
        "type": "function",
        "z": "9d68a1c7.f4976",
        "name": "地理院地図",
        "func": "msg.payload = {\n    command:{\"map\":{\n                    \"name\":\"GSI\",\n                    \"url\":\"https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png\",\n                    \"opt\":{ \"maxZoom\":19, \n                            \"attribution\":\"&copy; OpenStreetMap\" \n                        }\n                    }\n            }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 620,
        "wires": [
            [
                "35707fe6.09419"
            ]
        ]
    },
    {
        "id": "79c48fed.4c46",
        "type": "ui_button",
        "z": "9d68a1c7.f4976",
        "name": "",
        "group": "4707e75.554a618",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "button",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 770,
        "y": 520,
        "wires": [
            [
                "5976f7cc.62d488"
            ]
        ]
    },
    {
        "id": "5976f7cc.62d488",
        "type": "change",
        "z": "9d68a1c7.f4976",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "select",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 950,
        "y": 520,
        "wires": [
            [
                "c1b3c6cc.ebf4d8"
            ]
        ]
    },
    {
        "id": "774c9735.169ef8",
        "type": "debug",
        "z": "9d68a1c7.f4976",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1390,
        "y": 600,
        "wires": []
    },
    {
        "id": "c1b3c6cc.ebf4d8",
        "type": "switch",
        "z": "9d68a1c7.f4976",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1移動",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "2移動",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "3移動",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 1030,
        "y": 620,
        "wires": [
            [
                "f02614a.69a6ce8"
            ],
            [],
            []
        ]
    },
    {
        "id": "f02614a.69a6ce8",
        "type": "change",
        "z": "9d68a1c7.f4976",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.lat",
                "pt": "msg",
                "to": "lat1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "payload.lon",
                "pt": "msg",
                "to": "lon1",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1200,
        "y": 600,
        "wires": [
            [
                "774c9735.169ef8"
            ]
        ]
    },
    {
        "id": "b8b1cea0.7dd62",
        "type": "worldmap-tracks",
        "z": "f20b3fe7.75306",
        "name": "",
        "depth": 20,
        "layer": "combined",
        "smooth": false,
        "x": 610,
        "y": 800,
        "wires": [
            [
                "d05bfb3e.19f178"
            ]
        ]
    },
    {
        "id": "d05bfb3e.19f178",
        "type": "debug",
        "z": "f20b3fe7.75306",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 800,
        "wires": []
    },
    {
        "id": "251d272f.2b9198",
        "type": "worldmap-tracks",
        "z": "8caaa155.e5486",
        "name": "",
        "depth": 20,
        "layer": "combined",
        "smooth": false,
        "x": 790,
        "y": 360,
        "wires": [
            [
                "343d9210.1d544e"
            ]
        ]
    },
    {
        "id": "343d9210.1d544e",
        "type": "debug",
        "z": "8caaa155.e5486",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 360,
        "wires": []
    }
]